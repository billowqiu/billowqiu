<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="taocoding">
<meta property="og:url" content="http://yoursite.com/page/10/index.html">
<meta property="og:site_name" content="taocoding">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="taocoding">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/10/">





  <title>taocoding</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d13234060d812cb98a47e937139083a9";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">taocoding</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/07/14/c中回调callback的使用方法/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2009/07/14/c中回调callback的使用方法/" itemprop="url">C++中回调(CallBack)的使用方法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-07-14T23:55:00+08:00">
                2009-07-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index">
                    <span itemprop="name">C++</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>回调函数是一个很有用，也很重要的概念。当发生某种事件时，系统或其他函数将会自动调用你定义的一段函数。回调函数在windows编程使用的场合很多，比如Hook回调函数：MouseProc,GetMsgProc以及EnumWindows,DrawState的回调函数等等，还有很多系统级的回调过程。 一般情况下, 我们使用的回调函数基本都是采用C语言风格. 这里介绍一种C++风格的回调对象方法. 采用template实现.</p>
<p>template &lt; class Class, typename ReturnType, typename Parameter &gt;&nbsp;&nbsp;<br>class SingularCallBack&nbsp;&nbsp;<br>{&nbsp;&nbsp;&nbsp;<br>public:&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp; typedef ReturnType (Class::<em>Method)(Parameter);&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp; SingularCallBack(Class</em> _class_instance, Method _method)&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //取得对象实例地址,及调用方法地址&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; class_instance = _class_instance;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; method&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = _method;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; };&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp; ReturnType operator()(Parameter parameter)&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 调用对象方法&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return (class_instance-&gt;<em>method)(parameter);&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; };&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp; ReturnType execute(Parameter parameter)&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 调用对象方法&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return operator()(parameter);&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; };&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;<br>&nbsp;&nbsp; private:&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp; Class</em>&nbsp; class_instance;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; Method&nbsp; method;&nbsp;&nbsp;<br>&nbsp;<br>};&nbsp;<br>示例:</p>
<p>以下是两个类实现.<br>class A&nbsp;&nbsp;<br>{&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp; public:&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp; void output()&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; std::cout &lt;&lt; “I am class A :D” &lt;&lt; std::endl;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; };&nbsp;&nbsp;<br>&nbsp;<br>};&nbsp;&nbsp;<br>&nbsp;<br>class B&nbsp;&nbsp;<br>{&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp; public:&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp; bool methodB(A a)&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.output();&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;<br>&nbsp;<br>};&nbsp;&nbsp;<br>&nbsp;</p>
<p>SingularCallBack的各种调用示例:<br>A a;<br>B b;</p>
<p>SingularCallBack&lt; B,bool,A &gt;* cb;<br>cb = new SingularCallBack&lt; B,bool,A &gt;(&amp;b,&amp;B::methodB);</p>
<p>if(cb-&gt;execute(a))<br>{<br>&nbsp;&nbsp; std::cout &lt;&lt; “CallBack Fired Successfully!” &lt;&lt; std::endl;<br>}<br>else<br>{<br>&nbsp;&nbsp; std::cout &lt;&lt; “CallBack Fired Unsuccessfully!” &lt;&lt; std::endl;<br>}<br>&nbsp;&nbsp;<br>class AClass&nbsp;&nbsp;<br>{&nbsp;&nbsp;<br>&nbsp;&nbsp; public:&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; AClass(unsigned int _id): id(_id){};&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; ~AClass(){};&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; bool AMethod(std::string str)&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; std::cout &lt;&lt; “AClass[“ &lt;&lt; id &lt;&lt; “]: “ &lt;&lt; str &lt;&lt; std::endl;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; };&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp; private:&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp; unsigned int id;&nbsp;&nbsp;<br>&nbsp;<br>};&nbsp;&nbsp;&nbsp;</p>
<p>typedef SingularCallBack &lt; AClass, bool, std::string &gt; ACallBack;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;</p>
<p>int main()&nbsp;&nbsp;<br>{&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp; std::vector &lt; ACallBack &gt; callback_list;&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp; AClass a1(1);&nbsp;&nbsp;<br>&nbsp;&nbsp; AClass a2(2);&nbsp;&nbsp;<br>&nbsp;&nbsp; AClass a3(3);&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp; callback_list.push_back(ACallBack(&amp;a1, &amp;AClass::AMethod));&nbsp;&nbsp;<br>&nbsp;&nbsp; callback_list.push_back(ACallBack(&amp;a2, &amp;AClass::AMethod));&nbsp;&nbsp;<br>&nbsp;&nbsp; callback_list.push_back(ACallBack(&amp;a3, &amp;AClass::AMethod));&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp; for (unsigned int i = 0; i &lt; callback_list.size(); i++)&nbsp;&nbsp;<br>&nbsp;&nbsp; {&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; callback_list<a href="&quot;abc&quot;">i</a>;&nbsp;&nbsp;<br>&nbsp;&nbsp; }&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp; for (unsigned int i = 0; i &lt; callback_list.size(); i++)&nbsp;&nbsp;<br>&nbsp;&nbsp; {&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; callback_list[i].execute(“abc”);&nbsp;&nbsp;<br>&nbsp;&nbsp; }&nbsp;&nbsp;<br>&nbsp;<br>&nbsp;&nbsp; return true;&nbsp;&nbsp;<br>&nbsp;<br>}&nbsp;&nbsp;<br>&nbsp;</p>
<p>引用:</p>
<p>C++ Callback Solution </p>
<p>本文来自CSDN博客，转载请标明出处：<a href="http://blog.csdn.net/force_eagle/archive/2009/07/14/4347329.aspx" target="_blank" rel="noopener">http://blog.csdn.net/force_eagle/archive/2009/07/14/4347329.aspx</a></p>
<p></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/07/09/im的技术原理与发展/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2009/07/09/im的技术原理与发展/" itemprop="url">IM的技术原理与发展</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-07-09T01:19:00+08:00">
                2009-07-09
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/未分类/" itemprop="url" rel="index">
                    <span itemprop="name">未分类</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>一、IM技术概念</p>
<p>IM技术全称Instant Messaging，中文翻译&ldquo;即时通讯&rdquo;，它是一种使人们能在网上识别在线用户并与他们实时交换消息的技术，是电子邮件发明以来迅速崛起的在线通讯方式。</p>
<p>IM的出现和互联网有着密不可分的关系，IM完全基于TCP/IP网络协议族实现，而TCP/IP协议族则是整个互联网得以实现的技术基础。 最早出现即时通讯协议是IRC（Internet Relay Chat），但是可惜的是它仅能单纯的使用文字、符号的方式通过互联网进行交谈和沟通。随着互连网变得高度发达，即时通讯也变得远不止聊天这么简单，自1996年第一个IM产品ICQ发明后，IM的技术和功能也开始基本成型，语音、视频、文件共享、短信发送等高级信息交换功能都可以在IM工具上实现，于是功能强大的IM软件便足以搭建一个完整的通信交流平台。目前最具代表性的几款的IM通讯软件有MSN、Google Talk、Yahoo、Messenger 、腾讯QQ等。</p>
<p>二、IM技术原理和工作方式</p>
<p>典型的IM工作方式如下：登陆IM通讯中心（IM通讯服务器），获取一个自建立的历史的交流对象列表（好友列表），然后自身标志为在线状态，当好友列表中的某人在任何时候登录上线并试图通过你的计算机联系你时，IM系统会发一个消息提醒你，然后你能与他建立一个聊天会话通道进行各种消息如键入文字、通过语音等的交流，<br>从技术上来说，IM的基本技术原理如下：</p>
<p>IM服务器<br>登陆或注销<br>用户A通过列表找到B，用户B获得的消息并与之交谈<br>通过IM服务器指引建立与B单独的通讯通道</p>
<p>第一步，用户A输入自己的用户名和密码登录IM服务器，服务器通过读取用户数据库来验证用户身份，如果验证通过，登记用户A的IP地址、IM客户端软件的版本号及使用的TCP/UDP端口号，然后返回用户A登录成功的标志，此时用户A在IM系统中的状态为在线（Online Presence）。</p>
<p>第二步，根据用户A存储在IM服务器上的好友列表（Buddy List），服务器将用户A在线的相关信息发送给也同时在线的IM好友的PC机，这些信息包括在线状态、IP地址、IM客户端使用的TCP端口（Port）号等，IM好友的客户端收到此信息后将在予以提示。</p>
<p>第三步是IM服务器把用户A存储在服务器上的好友列表及相关信息回送到他的客户端机，这些信息包括也在线状态、IP地址、IM客户端使用的TCP端口（Port）号等信息，用户A的IM客户端收到后将显示这些好友列表及其在线状态。</p>
<p>三、IM通讯方式</p>
<p>1.在线直接通讯<br>如果用户A想与他的在线好友用户B聊天，他将直接通过服务器发送过来的用户B的IP地址、TCP端口号等信息，直接向用户B的PC机发出聊天信息，用户B的IM客户端软件收到后显示在屏幕上，然后用户B再直接回复到用户A的PC机，这样双方的即时文字消息就不再IM服务器中转，而是直接通过网络进行点对点的通讯，即对等通讯方式（Peer To Peer）。</p>
<p>2.在线代理通讯<br>用户A与用户B的点对点通讯由于防火墙、网络速度等原因难以建立或者速度很慢，IM服务器将会主动提供消息中转服务，即用户A和用户B的即时消息全部先发送到IM服务器，再由服务器转发给对方。</p>
<p>3.离线代理通讯<br>用户A与用户B由于各种原因不能同时在线的时候，如此时A向B发送消息，IM服务器可以主动寄存A用户的消息，到B用户下一次登陆的时候，自动将消息转发给B。</p>
<p>4.扩展方式通讯<br>用户A可以通过IM服务器将信息以扩展的方式传递给B，如短信发送方式发送到B的手机，传真发送方式传递给B的电话机，以email的方式传递给B的电子邮箱等。<br>早期的IM系统，在IM客户端和IM服务器之间通讯采用UDP协议，UDP协议是不可靠的传输协议，而在IM客户端之间的直接通讯中，采用具备可靠传输能力的TCP协议。随着用户需求和技术环境的发展，目前主流的IM系统倾向于在IM客户端之间、IM客户端和IM服务器之间都采用TCP协议。<br>即时通讯相对于其他通讯方式如电话、传真、email等的最大优势就是消息传达的即时性和精确性，只要消息传递双方均在网络上可以互通，使用即时通讯软件传递消息，传递延时仅为1秒种</p>
<p>四、兴起的嵌入式IM工具。</p>
<p>传统的IM在统治了互联网即时通讯领域长达十年之久，以其日趋稳定的定能，与较强的用户黏着度，至今仍统治着这个巨大的市场。然而，软件行业的技术精英们，并不满足于此。他们厚积薄发，一直致力于开发出性能更为优越的即时通讯工具。当然，在功能上的不断完善，自然是一个必然的发展方向，在Web2.0时代，如何大力增强用户对网站的黏着度，而不仅仅是对于IM的拥附，已经成为他们的主攻方向了。于是，嵌入式IM工具，应运而生了。</p>
<p>相对以往的传统的即使沟通工具，它们需要用户下载软件包，需要用户进行安装。对于拥有IM产品的网站而言，用户在登陆网站后，不能直接使用其IM工具，对于流量与用户的黏着度，都是有一定影响的。因此在IM与网站相互依存的今天，没有哪家网络公司，愿意将IM工具孤立开来。</p>
<p>于是，目前，一种新型的嵌入式IM工具就应运而生了。这种IM工具，不需要下载安装，当用户登陆网页后，该IM直接嵌套在网页中，可以直接使用。</p>
<p>而在功能上，则一点也不输于传统的IM，无论是传统的文字沟通的速度与效率，还是近年来越来越成为IM工具必备的音频/视频功能，这种嵌入式IM都能提供非常稳定的传输。更值得一提的是，因为嵌入式IM是嵌套在网页上的，软件供应商，可以根据网站需求，设计出适合网站风格的IM产品。而不是像传统的IM工具，千篇一律，毫无个性可言。</p>
<p>目前，这类嵌入式IM在社区、交友、社团及协作等类型的网站上，应用已经较为广泛。在Web2.0时代，将发挥越来越重要的作用。 </p>
<p></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/07/06/vs2005内存泄漏检测方法/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2009/07/06/vs2005内存泄漏检测方法/" itemprop="url">VS2005内存泄漏检测方法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-07-06T00:55:00+08:00">
                2009-07-06
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/VC/" itemprop="url" rel="index">
                    <span itemprop="name">VC</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <pre><code>&lt;div&gt;
</code></pre><p>原文地址：&nbsp;<a href="http://ufownl.blog.163.com/blog/static/1250122200861912757566/" target="_blank" rel="noopener">http://ufownl.blog.163.com/blog/static/1250122200861912757566/</a></p>
<p>非MFC程序可以用以下方法检测内存泄露：</p>
<p>&nbsp;</p>
<p>1.程序开始包含如下定义：</p>
<p>#define _CRTDBG_MAP_ALLOC</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;crtdbg.h&gt;</p>
<p>&nbsp;</p>
<p>2.程序退出前添加下面的函数：</p>
<p>_CrtDumpMemoryLeaks();</p>
<p>&nbsp;</p>
<p>Debug版本程序运行结束后如有内存泄漏，输出窗口中会显示类似信息：<br>Detected memory leaks!<br>Dumping objects -&gt;<br>e:/microsoft visual studio 8/vc/include/crtdbg.h(1150) : {48} normal block at 0x00382F50, 12 bytes long.<br>&nbsp;Data: &lt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt; 01 00 00 00 02 00 00 00 03 00 00 00<br>Object dump complete.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>MFC程序内存泄漏检测方法：</p>
<p>&nbsp;</p>
<p>1.在 CMyApp 中添加如下三个 CMemoryState 类的成员变量：</p>
<p>#ifdef _DEBUG<br>protected:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CMemoryState m_msOld, m_msNew, m_msDiff;</p>
<p>#endif&nbsp; // _DEBUG</p>
<p>&nbsp;</p>
<p>2.在 CMyApp::InitInstance() 中添加如下代码：</p>
<p>#ifdef _DEBUG<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_msOld.Checkpoint();</p>
<p>#endif&nbsp; // _DEBUG</p>
<p>&nbsp;</p>
<p>3.在 CMyApp::ExitInstance() 中添加如下代码：</p>
<p>#ifdef _DEBUG<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_msNew.Checkpoint();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (m_msDiff.Difference(m_msOld, m_msNew))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; afxDump&lt;&lt;”/nMemory Leaked :/n”;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_msDiff.DumpStatistics();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; afxDump&lt;&lt;”Dump Complete !/n/n”;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>#endif&nbsp; // _DEBUG</p>
<p>&nbsp;</p>
<p>Debug版本程序运行结束后如有内存泄漏，输出窗口中会显示类似信息：</p>
<p>Memory Leaked :<br>0 bytes in 0 Free Blocks.<br>8 bytes in 1 Normal Blocks.<br>0 bytes in 0 CRT Blocks.<br>0 bytes in 0 Ignore Blocks.<br>0 bytes in 0 Client Blocks.<br>Largest number used: 8825 bytes.<br>Total allocations: 47506 bytes.<br>Dump Complete !</p>
<p>Detected memory leaks!<br>Dumping objects -&gt;<br>g:/programs/chat/chatdlg.cpp(120) : {118} normal block at 0x00D98150, 8 bytes long.<br>&nbsp;Data: &lt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt; A8 7F D9 00 01 00 00 00<br>Object dump complete.</p>
<p><br></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/07/05/代理类surrogate/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2009/07/05/代理类surrogate/" itemprop="url">代理类(Surrogate)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-07-05T23:44:00+08:00">
                2009-07-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index">
                    <span itemprop="name">C++</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 依然是学习&lt;Ruminations On c++&gt;的一点笔记。</p>
<p>问题的提出是：怎样设计一个C++容器，使它有能力包含类型不同而彼此相关的对象呢？</p>
<p>容器通常只能包含一种类型的对象，所以很难在容器中存储对象本身，最容易想到的就是存储指针(我目前在项目中使用的也是这种方法)，这样虽然可以通过继承来处理类型不同的问题，但是也增加了内存分配的额外负担。</p>
<p>书中介绍了一种叫做代理的对象来解决这个问题，代理类是句柄类中最简单的一种，下面是一个简单的代理类实现：</p>
<pre style="border: 1px dotted #785;background: #f5f5f5;">// Surrogate.cpp : 定义控制台应用程序的入口点。
//
#include "stdafx.h"

#define _CRTDBG_MAP_ALLOC
#include &lt;stdlib.h&gt;
#include &lt;crtdbg.h&gt;

#include &lt;iostream&gt;
#include &lt;vector&gt;
using namespace std;

class Vehicle
{
public:
virtual double weight()const =0;
virtual void   start()=0;
virtual Vehicle* copy()const=0;//用来复制编译时类型未知的对象
virtual ~Vehicle()//以便调用正确的派生类析构函数
{

}
//...
};

class RoadVehicle : public Vehicle
{
public:
double weight()const
{
cout&lt;&lt;"RoadVehicle::weight()"&lt;&lt;endl;
return 0;
}
void   start()
{
cout&lt;&lt;"RoadVehicle::start()"&lt;&lt;endl;
}
Vehicle* copy()const
{
return new RoadVehicle(*this);
}
/**/
};

class AutoVehicle : public RoadVehicle
{
public:
double weight()const
{
cout&lt;&lt;"AutoVehicle::weight()"&lt;&lt;endl;
return 0;
}
void   start()
{
cout&lt;&lt;"AutoVehicle::start()"&lt;&lt;endl;
}
Vehicle* copy()const
{
return new AutoVehicle(*this);
}
/**/
};

class Aircraft : public Vehicle
{
public:
double weight()const
{
cout&lt;&lt;"Aircraft::weight()"&lt;&lt;endl;
return 0;
}
void   start()
{
cout&lt;&lt;"Aircraft::start()"&lt;&lt;endl;
}
Vehicle* copy()const
{
return new Aircraft(*this);
}
/**/
};

class Helicopter : public Aircraft
{
public:
double weight()const
{
cout&lt;&lt;"Helicopter::weight()"&lt;&lt;endl;
return 0;
}
void   start()
{
cout&lt;&lt;"Helicopter::start()"&lt;&lt;endl;
}
Vehicle* copy()const
{
return new Helicopter(*this);
}
/**/
};

//代理类
class VehicleSurrogate
{
public:
VehicleSurrogate();
VehicleSurrogate(const Vehicle&amp;);
~VehicleSurrogate();
VehicleSurrogate(const VehicleSurrogate&amp;);
VehicleSurrogate&amp; operator=(const VehicleSurrogate&amp;);

//来自类Vehicle的操作
double weight()const;
void start();
private:
Vehicle *vp;
};

VehicleSurrogate::VehicleSurrogate():vp(0)
{

}

VehicleSurrogate::VehicleSurrogate(const Vehicle&amp; v):vp(v.copy())
{

}

VehicleSurrogate::~VehicleSurrogate()
{
delete vp;
}

VehicleSurrogate::VehicleSurrogate(const VehicleSurrogate&amp; v):vp(v.vp?v.vp-&gt;copy():0)
{

}

VehicleSurrogate&amp; VehicleSurrogate::operator=(const VehicleSurrogate&amp; v)
{
if (this!=&amp;v)
{
delete vp;
vp=(v.vp?v.vp-&gt;copy() : 0);
}
return *this;
}

//直接转发给vp调用
double VehicleSurrogate::weight()const
{
if (vp==0)
{
throw "empty VehicleSurrogate.weight()";
}
return vp-&gt;weight();
}

void VehicleSurrogate::start()
{
if (vp==0)
{
throw "empty VehicleSurrogate.start()";
}
vp-&gt;start();
}

int _tmain(int argc, _TCHAR* argv[])
{
vector&lt;VehicleSurrogate&gt; vecVS;

RoadVehicle rv;
Aircraft ar;
AutoVehicle av;
Helicopter hc;
vecVS.push_back(rv);
vecVS.push_back(ar);
vecVS.push_back(av);
vecVS.push_back(hc);

vector&lt;VehicleSurrogate&gt;::iterator iter=vecVS.begin();
vector&lt;VehicleSurrogate&gt;::iterator iterEnd=vecVS.end();
while(iter!=iterEnd)
{
iter-&gt;weight();
iter-&gt;start();
iter++;
}

_CrtDumpMemoryLeaks();

return 0;
}</pre> 

<p>下面是测试结果，使用VS2005发现有内存泄漏，暂时没找到原因。</p>
<p><img src="http://p.blog.csdn.net/images/p_blog_csdn_net/ToCpp/EntryImages/20090706/Surrogate.png" alt="result"></p>
<p></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/06/29/wm-nchittest的几点心得/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2009/06/29/wm-nchittest的几点心得/" itemprop="url">WM_NCHITTEST的几点心得</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-06-29T01:43:00+08:00">
                2009-06-29
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/VC/" itemprop="url" rel="index">
                    <span itemprop="name">VC</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>1：WM_NCHITTEST是作为Non-Client测试使用的，</strong></p>
<p><strong>2：当此消息的返回值为MSDN上面所述的<span style="color: #0000ff;"><span style="text-decoration: underline;">DefWindowProc</span></span></strong><span style="color: #000000;"><strong>所规定的相应值时，系统才会进一步产生相应的客户区或者非客户区鼠标消息，而且在你使用OnNcCalcSize时自定义的非客户区内，系统是不会产生任何鼠标消息的，除非你返回一个值以表示当前鼠标在哪个区域，毕竟对于你的区域系统也不知道该返回什么值</strong></span></p>
<p><strong>3：除了返回<span style="color: #0000ff;"><span style="text-decoration: underline;">HTCLIENT</span><span style="color: #000000;"><span style="text-decoration: underline;">，</span>其他任何值系统都会产生相应的NC鼠标消息</span></span></strong></p>
<p><strong><span style="color: #0000ff;"></span></strong></p>
<p><strong><span style="color: #0000ff;"><span style="color: #000000;">这个消息困惑好久了，今天测试了下才发现是这样的，真是恍然大悟，明天做个例子测试下。</span></span></strong></p>
<p></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/06/17/应用器-ampampamp-操纵器/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2009/06/17/应用器-ampampamp-操纵器/" itemprop="url">应用器 & 操纵器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-06-17T23:44:00+08:00">
                2009-06-17
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index">
                    <span itemprop="name">C++</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 操纵器(Manipalator)，以某种方式作用于它的参数所表示的数据；应用器(Applicator)，是一个重载操作符，它的操作数是一个可操纵的值和一个将作用于这个值得操纵器。</p>
<p>&nbsp;template &lt;class stype,class vtype &gt;<br>class fcn_obj<br>{<br>public:<br>&nbsp; fcn_obj(stype (<em>f)(stype&amp;,vtype),vtype v):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; func(f),val(v)<br>&nbsp; {<br>&nbsp; }<br>&nbsp; stype&amp; operator()(stype&amp; s)const<br>&nbsp; {<br>&nbsp;&nbsp;&nbsp; return (</em>func)(s,val);<br>&nbsp; }<br>private:<br>&nbsp; stype&amp; (*func)(stype&amp;,vtype),vtype v);<br>&nbsp; vtype val;<br>};</p>
<p>template &lt;class stype,class vtype&gt;<br>stype&amp; operator&lt;&lt;<br>(stype&amp; ofile,const fcn_obj&lt;stype,vtype&gt;&amp; im)<br>{<br>&nbsp;&nbsp; return im(ofile);<br>}</p>
<p>fun_obj&lt;ostream long&gt;<br>hexconv(long n)<br>{<br>&nbsp;&nbsp; ostream (*my_hex)(ostream&amp;,long)=hexconv;<br>&nbsp;&nbsp; return fcn_obj&lt;ostream,long&gt;(my_hex,n);<br>}</p>
<p>&nbsp;</p>
<p>上面的代码来自Ruminations On C++，iostream库中使用了这个设计，使得cout&lt;&lt;”Hello,World!”&lt;&lt;endl;用起来很舒服，终于知道了endl为什么叫做操纵器了。</p>
<p></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/06/14/回调函数指南/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2009/06/14/回调函数指南/" itemprop="url">回调函数指南</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-06-14T18:38:00+08:00">
                2009-06-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index">
                    <span itemprop="name">C++</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; font-size: 15pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;"><span lang="EN-US"></span></span></strong></p>
<p><strong><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; font-size: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">作者： <span lang="EN-US">Marius Bancila</span></span></strong></p>
<p><strong><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; font-size: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">翻译<span lang="EN-US">:<span style="mso-spacerun: yes;">&nbsp; </span>QiuTao</span></span>**</strong><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; font-size: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US"></span>**</p>
<p><strong><span style="font-family: 宋体; color: black; font-size: 14pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">介绍</span>**</strong><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; font-size: 14pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"></span>**</p>
<p><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast; mso-bidi-font-weight: bold;">如果你正在读这篇文章，也许你是想知道什么是回调函数。这篇文章讲解了什么是回调函数，他们有什么优点，以及为什么你要使用他们等等。但是在学习回调函数之前，你应该对函数指针有一定得了解。如果你还不了解，可以参考<span lang="EN-US">C/C++</span>书籍或者下面的链接：</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;" lang="EN-US"></span></span></p>
<ul>
<li><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><a href="http://www.newty.de/fpt/fpt.html" target="_blank" rel="noopener"><span style="color: blue; mso-bidi-font-size: 11.0pt;">The Syntax of C and C++ Function Pointers</span></a> </span></li>
<li><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><a href="http://www.parashift.com/c++-faq-lite/pointers-to-members.html" target="_blank" rel="noopener"><span style="color: blue; mso-bidi-font-size: 11.0pt;">Pointers to member functions</span></a> </span></li>
<li><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><a href="http://www.eskimo.com/~scs/cclass/int/sx10a.html" target="_blank" rel="noopener"><span style="color: blue; mso-bidi-font-size: 11.0pt;">Declaring, Assigning, and Using Function Pointers</span></a> </span></li>
</ul>
<p><strong><span style="font-family: 宋体; color: black; font-size: 14pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">什么是回调函数？</span>**</strong><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; font-size: 14pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"></span>**</p>
<p><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">对这个问题的一个简单回答就是，回调函数是一个通过函数指针调用的函数。如果你传递一个函数指针</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US">(</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">地址</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US">)</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">参数给另一个函数，当那个指针被用作去调用它所指的函数时，回调就产生了。</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US"></span></span></p>
<p><strong><span style="font-family: 宋体; color: black; font-size: 14pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">为什么要使用回调函数？</span>**</strong><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; font-size: 14pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"></span>**</p>
<p><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-weight: bold;">因为他们将调用者和被调者分开了，调用者不需要关心被调者，它仅仅需要知道被调者的原型以及某些可能的限制</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体; mso-bidi-font-weight: bold;" lang="EN-US">(</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-weight: bold;">例如，返回值可以为</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体; mso-bidi-font-weight: bold;" lang="EN-US">int,</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-weight: bold;">但是特定的只有特定的意义</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体; mso-bidi-font-weight: bold;" lang="EN-US">)</span></span></p>
<p><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-weight: bold;">如果你想知道在它在现实中的用途，想象一下你想写一个提供实现排序算法的库，比如冒泡排序，希尔排序，快速排序等等。但是你不想将排序的逻辑</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体; mso-bidi-font-weight: bold;" lang="EN-US">(</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-weight: bold;">元素之间的先后关系</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体; mso-bidi-font-weight: bold;" lang="EN-US">)</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-weight: bold;">放在你的函数中，从而使得库更加易于使用。你希望客户自己实现排序之间的逻辑关系，或者你希望可以用于各种各样的数据类型</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体; mso-bidi-font-weight: bold;" lang="EN-US">(int,floats,strings</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-weight: bold;">等等</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体; mso-bidi-font-weight: bold;" lang="EN-US">)</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-weight: bold;">。你该怎么办呢？你可以使用函数指针并进行回调。</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体; mso-bidi-font-weight: bold;" lang="EN-US"></span></span></p>
<p><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-weight: bold;">回调可以被用作通知，例如。你需要在程序中设置一个定时器，每当一段时间过去后，你的程序必须被通知。但是，定时器的实现机制对你的程序一无所知。它仅仅希望一个给定原型的函数指针，并使用函数指针进行回调，通知你的程序某个事件发生了。确实，</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体; mso-bidi-font-weight: bold;" lang="EN-US">API</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-weight: bold;">函数</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体; mso-bidi-font-weight: bold;" lang="EN-US">SetTimer</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-weight: bold;">在一段时间到达后使用一个回调进行通知</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体; mso-bidi-font-weight: bold;" lang="EN-US">(</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-weight: bold;">如果没有提供回调函数，它将给应用程序队列投递一个消息</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体; mso-bidi-font-weight: bold;" lang="EN-US">)</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-weight: bold;">。</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体; mso-bidi-font-weight: bold;" lang="EN-US"></span></span></p>
<p><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-weight: bold;">另外一个使用回调函数的</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体; mso-bidi-font-weight: bold;" lang="EN-US">API</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-weight: bold;">函数</span></span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; font-size: 8pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">EnumWindow</span><span style="font-family: 宋体; color: black; font-size: 8pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">，</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;"><span style="font-size: small;">枚举当前屏幕中所有的顶层窗口。</span></span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; font-size: 8pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">EnumWindow</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;"><span style="font-size: small;">迭代每一个顶层窗口，传递一个窗口句柄给提供的回调函数。如果被调者返回一个值，那么迭代继续，否则迭代停止。</span></span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; font-size: 8pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">EnumWindow</span><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">并不关系被调用者是什么以及它对传读过去的句柄做了些什么，它仅仅对其返回值感兴趣，因为它是基于该返回值决定是否需要继续执行。</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US"></span></span></p>
<p><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">然而，回调函数是从</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US">C</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">继承而来的，因此，在</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US">C++</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">中应该仅仅在需要与</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US">C</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">代码中进行交互时使用，除此之外，你应该使用虚拟函数或者函数对象，而不是回调函数。</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体; mso-bidi-font-weight: bold;" lang="EN-US"></span></span></p>
<p><strong><span style="font-family: 宋体; color: black; font-size: 14pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">一个简单的实现例子</span>**</strong><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; font-size: 14pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"></span>**</p>
<p><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: minor-fareast; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast;"><span style="font-size: small;">下面的例子可以再附件文件中找到，我创建了一个叫做<span lang="EN-US">sort.dll</span>的动态链接库。它导出了一个叫做<span lang="EN-US">CompareFunction</span>类型的函数：<span lang="EN-US"></span></span></span></p>
<div style="background: #eeeeee; mso-element: para-border-div; mso-border-alt: solid #999999 .75pt; border: #999999 1pt solid; padding: 7pt;"><br><br><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">typedef</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> (</span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">__stdcall</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> <em>CompareFunction)(</em></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">const</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">byte</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">, </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">const</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">byte</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">*);</span><br><br></div>

<p><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">该函数原型是你的回调函数的类型，另外还导出了两个方法，分别是</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US">BubbleSort</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">和</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US">QuickSort</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">，这两个函数有一样的原型，但是提供了不一样的排序算法。</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US"></span></span></p>
<div style="background: #eeeeee; mso-element: para-border-div; mso-border-alt: solid #999999 .75pt; border: #999999 1pt solid; padding: 7pt;"><br><br><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">void</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> DLLDIR </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><strong>stdcall</strong></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> Bubblesort(</span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">byte</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">* array,</span><br><br><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> size,</span><br><br><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> elem_size,</span><br><br><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CompareFunction cmpFunc);</span><br><br><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">&nbsp;</span><br><br><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">void</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> DLLDIR </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">stdcall</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> Quicksort(</span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">byte</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">* array,</span><br><br><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> size,</span><br><br><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> elem_size,</span><br><br><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CompareFunction cmpFunc);</span><br><br></div>

<p><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">各个参数的意义为：</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US"></span></span></p>
<p><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt;">※</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US">byte* array:</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">指向数组元素类型的指针</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US">(</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">任意类型</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US">)</span></span></p>
<p><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt;">※</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US">int size</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">：数组元素个数</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; font-size: 8pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"></span></span></p>
<p><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt;">※</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US">int elem_size:</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">数组中每一个元素的大小，按字节计算</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US"></span></span></p>
<p><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt;">※</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US">CompareFunction cmpFunc:</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">回调函数指针</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US"></span></span></p>
<p><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">这两个函数的实现都是对一个数组进行排序，但是，每一次都需要决定两个元素中哪个在前面，被作为参数传递的回调函数地址即是进行。对于库编写者，它不需要关心这个函数是否实现了，以及是如何实现的。它所关心的是这个函数带有两个以元素地址为参数类型的参数并返回下面值之一</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US">(</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">这是库开发者和用户之间约定的</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US">)</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">：</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<ul>
<li><span style="font-size: small;"><span style="font-family: 宋体; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;" lang="EN-US">-1: </span><span style="font-family: 宋体; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;">如果第一个元素小于或者在第二个元素之前<span lang="EN-US"></span></span></span></li>
<li><span style="font-size: small;"><span style="font-family: 宋体; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;" lang="EN-US">0: </span><span style="font-family: 宋体; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;">如果两个元素相等或者相对位置没有规定<span lang="EN-US"></span></span></span></li>
<li><span style="font-size: small;"><span style="font-family: 宋体; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;" lang="EN-US">1:</span><span style="font-family: 宋体; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;">如果第一个元素大于或者在第二个元素之后<span lang="EN-US"></span></span></span></li>
</ul>
<p><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;"><span style="font-size: small;">在这些约定之后，</span></span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; font-size: 8pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">Bubblesort</span><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: minor-fareast; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast;">的实现如下<span lang="EN-US">(Quicksort</span>，比这稍微复杂点，可以参见附件<span lang="EN-US">):</span></span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;" lang="EN-US"></span></span></p>
<div style="background: #eeeeee; margin-left: 18pt; margin-right: 0cm; mso-element: para-border-div; mso-border-alt: solid #999999 .75pt; border: #999999 1pt solid; padding: 7pt;"><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">void</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> DLLDIR </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">__stdcall</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> Bubblesort(</span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">byte</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><em> array,</em></span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> size,</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> elem_size,</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>CompareFunction cmpFunc)</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">{</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">for</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">(</span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> i=0; i &lt; size; i++)</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span>{</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">for</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">(</span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> j=0; j &lt; size-1; j++)</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>{</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">// make the callback to the comparison function</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"></span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">if</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">(1 == (cmpFunc)(array+j<em>elem_size,</em></span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>array+(j+1)elem_size))</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>{</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">// the two compared elements must be interchanged</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"></span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">byte</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><em> temp = </em></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">new</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">byte</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">[elem_size];</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>memcpy(temp, array+jelem_size, elem_size);</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>memcpy(array+j<em>elem_size,</em></span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>array+(j+1)elem_size,</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>elem_size);</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>memcpy(array+(j+1)*elem_size, temp, elem_size);</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">delete</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> [] temp;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>}</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>}</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span>}</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">}</span><br><br></div>

<p><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><strong><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: minor-fareast; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast;"><span style="font-size: small;">注意：由于实现中使用了<span lang="EN-US">memcpy,</span>这个这些库函数只能在<span lang="EN-US">POD</span>类型中使用<span lang="EN-US"></span></span></span></strong></p>
<p><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: minor-fareast; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast;"><span style="font-size: small;">在客户端，他们必须实现一个通过地址传递给<span lang="EN-US">Bubblesor</span>函数的回调函数，作为一个简单的实现，我写了一个比较两个整形和字符串常量的例子：<span lang="EN-US"></span></span></span></p>
<div style="background: #eeeeee; margin-left: 18pt; margin-right: 0cm; mso-element: para-border-div; mso-border-alt: solid #999999 .75pt; border: #999999 1pt solid; padding: 7pt;"><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><strong>stdcall</strong></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> CompareInts(</span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">const</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">byte</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><em> velem1, </em></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">const</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">byte</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> velem2)</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">{</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> elem1 = <em>(</em></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">)velem1;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> elem2 = <em>(</em></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">)velem2;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">&nbsp;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">if</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">(elem1 &lt; elem2)</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">return</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> -1;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">if</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">(elem1 &gt; elem2)</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">return</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> 1;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">&nbsp;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">return</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> 0;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">}</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">&nbsp;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">stdcall</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> CompareStrings(</span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">const</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">byte</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><em> velem1, </em></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">const</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">byte</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> velem2)</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">{</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">const</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">char</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><em> elem1 = (</em></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">char</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">)velem1;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">const</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">char</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><em> elem2 = (</em></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">char</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">)velem2;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">&nbsp;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">return</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> strcmp(elem1, elem2);</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">}</span><br><br></div>

<p><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 8.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;"><span style="font-size: small;">为了将这些进行测试，我编写了一个简单的程序，传递一个包含<span lang="EN-US">5</span>个元素的数组以及相应的回调函数指针给</span></span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; font-size: 8pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">Bubblesort()</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;"><span style="font-size: small;">和</span></span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; font-size: 8pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">Quicksort()</span></p>
<div style="background: #eeeeee; margin-left: 18pt; margin-right: 0cm; mso-element: para-border-div; mso-border-alt: solid #999999 .75pt; border: #999999 1pt solid; padding: 7pt;"><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> main(</span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> argc, </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">char</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><em> argv[])</em></span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">{</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> i;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> array[] = {5432, 4321, 3210, 2109, 1098};</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">&nbsp;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span>cout &lt;&lt; “Before sorting ints with Bubblesort/n”;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">for</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">(i=0; i &lt; 5; i++)</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cout &lt;&lt; array[i] &lt;&lt; ‘/n’;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">&nbsp;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span>Bubblesort((</span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">byte</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">)array, 5, </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">sizeof</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">(array[0]), &amp;CompareInts);</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">&nbsp;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span>cout &lt;&lt; “After the sorting/n”;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">for</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">(i=0; i &lt; 5; i++)</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cout &lt;&lt; array[i] &lt;&lt; ‘/n’;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">&nbsp;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">const</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">char</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> str[5][10] = {“estella”,</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>“danielle”,</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;</span>“crissy”,</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>“bo”,</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>“angie”};</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">&nbsp;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span>cout &lt;&lt; “Before sorting strings with Quicksort/n”;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">for</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">(i=0; i &lt; 5; i++)</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cout &lt;&lt; str[i] &lt;&lt; ‘/n’;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">&nbsp;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span>Quicksort((</span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">byte</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">*)str, 5, 10, &amp;CompareStrings);</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">&nbsp;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span>cout &lt;&lt; “After the sorting/n”;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">for</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">(i=0; i &lt; 5; i++)</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cout &lt;&lt; str[i] &lt;&lt; ‘/n’;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">&nbsp;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">return</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> 0;</span><br><br><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">}</span><br><br></div>

<p><span style="font-family: Symbol; color: black; font-size: 10pt; mso-bidi-font-family: Symbol; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: Symbol;" lang="EN-US"><span style="mso-list: Ignore;">&middot;<span style="font: 7pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">如果我希望以降序排列</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US">(</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">最大的元素在第一个</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US">)</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">，需要做的只是改变回调函数代码或者提供另一个期望的回调函数。</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 宋体;" lang="EN-US"></span></span></p>
<p><strong><span style="font-family: 宋体; color: black; font-size: 14pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">调用约定</span>**</strong><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; font-size: 14pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"></span>**</p>
<p><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: minor-fareast; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-weight: bold;"><span style="font-size: small;">在上面的代码中，你可以看到在函数声明部分有个<span lang="EN-US"><strong>stdcall</strong></span>。由于它以一个双下划线开始，很显然这是一个编译器特定的扩展，更准确的说是微软特定的扩展。任何支持<span lang="EN-US">Win32</span>应用程序开发的编译器都提供这样或者与之等价的扩展。一个通过<span lang="EN-US">stdcall</span>标记的函数使用标准的调用约定，之所以这样叫是因为<span lang="EN-US">Win32API</span>函数<span lang="EN-US">(</span>除了部分带有可变参数列表的外<span lang="EN-US">)</span>使用它。遵循标准调用约定的函数，在返回调用者之前先清除堆栈中参数。这是源自<span lang="EN-US">Pascal</span>的标准调用约定。但是在<span lang="EN-US">C/C++</span>中，调用约定是调用者清理堆栈而不是被调用者。为了强制函数使用<span lang="EN-US">C/C++</span>函数调用，<span lang="EN-US">__cedecl</span>必须被指定。变参参数函数使用<span lang="EN-US">c/c++</span>调用约定。<span lang="EN-US"></span></span></span></p>
<p><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: minor-fareast; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-weight: bold;" lang="EN-US">Windows</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: minor-fareast; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-weight: bold;">采用<span lang="EN-US">Pascal</span>调用约定是因为它可以减少代码体积，这在早期运行在只有<span lang="EN-US">640kb RAM</span>的系统上的<span lang="EN-US">Windows</span>是非常重要的。<span lang="EN-US"></span></span></span></p>
<p><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: minor-fareast; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-weight: bold;"><span style="font-size: small;">如果你不喜欢<span lang="EN-US">__stdcall</span>，你也可以使用<span lang="EN-US">CALLBACK</span>宏，在<span lang="EN-US">windef.h</span>中定义如下：<span lang="EN-US"></span></span></span></p>
<div style="background: #eeeeee; mso-element: para-border-div; mso-border-alt: solid #999999 .75pt; border: #999999 1pt solid; padding: 7pt;"><br><br><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">#define</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> CALLBACK<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">__stdcall</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"></span><br><br></div>

<p><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; font-size: 8pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">or</span></p>
<div style="background: #eeeeee; mso-element: para-border-div; mso-border-alt: solid #999999 .75pt; border: #999999 1pt solid; padding: 7pt;"><br><br><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">#define</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> CALLBACK<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>PASCAL</span><br><br></div>

<p><span style="font-size: small;"><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: minor-fareast; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast;" lang="EN-US">PASCAL</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: minor-fareast; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast;">被定义为<span lang="EN-US">__stdcall</span></span></span></p>
<p><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: minor-fareast; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast;"><span style="font-size: small;">你可以通过连接</span></span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; font-size: 8pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><a href="http://www.hackcraft.net/cpp/MSCallingConventions/" target="_blank" rel="noopener"><span style="color: blue; mso-bidi-font-size: 11.0pt;">Calling Convetions in Microsoft Visual C++</span></a>.</span><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: minor-fareast; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast;"><span style="font-size: small;">获取更多调用约定的信息<span lang="EN-US"></span></span></span></p>
<p><strong><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; font-size: 14pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">C++</span>**</strong><span style="font-family: 宋体; color: black; font-size: 14pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana;">成员函数作为回调函数</span><strong>**<span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; font-size: 14pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"></span></strong></p>
<p><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: minor-fareast; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-weight: bold;"><span style="font-size: small;">由于你可能正在使用<span lang="EN-US">C++</span>，希望使用成员函数作为回调函数。但是，如果你进行下面的尝试：<span lang="EN-US"></span></span></span></p>
<div style="background: #eeeeee; mso-element: para-border-div; mso-border-alt: solid #999999 .75pt; border: #999999 1pt solid; padding: 7pt;"><br><br><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">class</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> CCallbackTester</span><br><br><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">{</span><br><br><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">public</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">:</span><br><br><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> CALLBACK CompareInts(</span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">const</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">byte</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><em> velem1, </em></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">const</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">byte</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"> velem2);</span><br><br><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">};</span><br><br><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">&nbsp;</span><br><br><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">Bubblesort((</span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">byte</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">*)array, 5, </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">sizeof</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">(array[0]),</span><br><br><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 9pt; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&amp;CCallbackTester::CompareInts);</span><br><br></div>

<p><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: minor-fareast; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast;"><span style="font-size: small;">如果使用<span lang="EN-US">MS</span>编译器，你将会得到下面的编译错误：<span lang="EN-US"></span></span></span></p>
<p><em><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; font-size: 8pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US">error C2664: ‘Bubblesort’ : cannot convert parameter 4 from ‘int (<strong>stdcall CCallbackTester::<em>)(const unsigned char </em>,const unsigned char *)’ to ‘int (</strong>stdcall <em>)(const unsigned char </em>,const unsigned char *)’ There is no context in which this conversion is possible</span></em><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; color: black; font-size: 8pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"></span></p>
<p><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: minor-fareast; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast;"><span style="font-size: small;">这是由于<span lang="EN-US">non-static</span>成员函数有一个额外参数，<span lang="EN-US">this</span>指针。<span lang="EN-US"></span></span></span></p>
<p><span style="font-family: 宋体; color: black; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt; mso-ascii-theme-font: minor-fareast; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast;"><span style="font-size: small;">这将迫使你使用<span lang="EN-US">static</span>成员函数，如果<span lang="EN-US">static</span>不能接受，你可以使用某些技术解决这个问题，可以通过下面的链接查找：<span lang="EN-US"></span></span></span></p>
<ul>
<li><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><a href="http://www.newty.de/fpt/callback.html" target="_blank" rel="noopener"><span style="color: blue; mso-bidi-font-size: 11.0pt;">How to Implement Callbacks in C and C++</span></a> </span></li>
<li><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><a href="http://www.codeguru.com/Cpp/Cpp/cpp_mfc/callbacks/article.php/c4129/" target="_blank" rel="noopener"><span style="color: blue; mso-bidi-font-size: 11.0pt;">C++ Callback Demo</span></a> </span></li>
<li><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt; mso-fareast-font-family: 宋体;" lang="EN-US"><a href="http://www.tutok.sk/fastgl/callback.html" target="_blank" rel="noopener"><span style="color: blue; mso-bidi-font-size: 11.0pt;">Callbacks in C++ Using Template Functors</span></a> </span><br></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/06/10/com初识/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2009/06/10/com初识/" itemprop="url">Com初识</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-06-10T01:48:00+08:00">
                2009-06-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/VC/" itemprop="url" rel="index">
                    <span itemprop="name">VC</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近决定真正的看看Com了，目前的理解：</p>
<p>必须实现IUnknow的三个接口，需要一个IDL文件，通过QueryInterface来获取接口并调用，直接用C++写比较繁琐，用ATL貌似是比较好的，还没具体研究过，先记到这，后续继续学习。</p>
<p></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/06/08/使用tinyxml解析xml/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2009/06/08/使用tinyxml解析xml/" itemprop="url">使用TinyXML解析XML</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-06-08T22:59:00+08:00">
                2009-06-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index">
                    <span itemprop="name">C++</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 由于工作需要，以前都是直接硬写在程序中的堆砌代码，现在决定都改为XML描述了，一来程序看起来清爽多了，二来以后扩展也方便。项目中使用的是TinyXML，今天去其官方网站逛了一圈，其中有个Tutorial写的很好，最后有个例子代码，个人感觉稍作修改完全可以拿到实际项目中使用，管他有多少个Node一个递归即搞定：<pre style="border: 1px dotted #785;background: #f5f5f5;">// tutorial demo program</pre></p>
<p>#include “stdafx.h”</p>
<p>#include “tinyxml.h”</p>
<p>// ———————————————————————-<br>// STDOUT dump and indenting utility functions<br>// ———————————————————————-<br>const unsigned int NUM_INDENTS_PER_SPACE=2;</p>
<p>const char <em> getIndent( unsigned int numIndents )<br>{<br>static const char </em> pINDENT=”                                      + “;<br>static const unsigned int LENGTH=strlen( pINDENT );<br>unsigned int n=numIndents*NUM_INDENTS_PER_SPACE;<br>if ( n &gt; LENGTH ) n = LENGTH;</p>
<p>return &amp;pINDENT[ LENGTH-n ];<br>}</p>
<p>// same as getIndent but no “+” at the end<br>const char <em> getIndentAlt( unsigned int numIndents )<br>{<br>static const char </em> pINDENT=”                                        “;<br>static const unsigned int LENGTH=strlen( pINDENT );<br>unsigned int n=numIndents*NUM_INDENTS_PER_SPACE;<br>if ( n &gt; LENGTH ) n = LENGTH;</p>
<p>return &amp;pINDENT[ LENGTH-n ];<br>}</p>
<p>int dump_attribs_to_stdout(TiXmlElement* pElement, unsigned int indent)<br>{<br>if ( !pElement ) return 0;</p>
<p>TiXmlAttribute<em> pAttrib=pElement-&gt;FirstAttribute();<br>int i=0;<br>int ival;<br>double dval;<br>const char</em> pIndent=getIndent(indent);<br>printf(“/n”);<br>while (pAttrib)<br>{<br>printf( “%s%s: value=[%s]”, pIndent, pAttrib-&gt;Name(), pAttrib-&gt;Value());</p>
<p>if (pAttrib-&gt;QueryIntValue(&amp;ival)==TIXML_SUCCESS)    printf( “ int=%d”, ival);<br>if (pAttrib-&gt;QueryDoubleValue(&amp;dval)==TIXML_SUCCESS) printf( “ d=%1.1f”, dval);<br>printf( “/n” );<br>i++;<br>pAttrib=pAttrib-&gt;Next();<br>}<br>return i;<br>}</p>
<p>void dump_to_stdout( TiXmlNode* pParent, unsigned int indent = 0 )<br>{<br>if ( !pParent ) return;</p>
<p>TiXmlNode<em> pChild;<br>TiXmlText</em> pText;<br>int t = pParent-&gt;Type();<br>printf( “%s”, getIndent(indent));<br>int num;</p>
<p>switch ( t )<br>{<br>case TiXmlNode::DOCUMENT:<br>printf( “Document” );<br>break;</p>
<p>case TiXmlNode::ELEMENT:<br>printf( “Element [%s]”, pParent-&gt;Value() );<br>num=dump_attribs_to_stdout(pParent-&gt;ToElement(), indent+1);<br>switch(num)<br>{<br>case 0:  printf( “ (No attributes)”); break;<br>case 1:  printf( “%s1 attribute”, getIndentAlt(indent)); break;<br>default: printf( “%s%d attributes”, getIndentAlt(indent), num); break;<br>}<br>break;</p>
<p>case TiXmlNode::COMMENT:<br>printf( “Comment: [%s]”, pParent-&gt;Value());<br>break;</p>
<p>case TiXmlNode::UNKNOWN:<br>printf( “Unknown” );<br>break;</p>
<p>case TiXmlNode::TEXT:<br>pText = pParent-&gt;ToText();<br>printf( “Text: [%s]”, pText-&gt;Value() );<br>break;</p>
<p>case TiXmlNode::DECLARATION:<br>printf( “Declaration” );<br>break;<br>default:<br>break;<br>}<br>printf( “/n” );<br>for ( pChild = pParent-&gt;FirstChild(); pChild != 0; pChild = pChild-&gt;NextSibling())<br>{<br>dump_to_stdout( pChild, indent+1 );<br>}<br>}</p>
<p>// load the named file and dump its structure to STDOUT<br>void dump_to_stdout(const char* pFilename)<br>{<br>TiXmlDocument doc(pFilename);<br>bool loadOkay = doc.LoadFile();<br>if (loadOkay)<br>{<br>printf(“/n%s:/n”, pFilename);<br>dump_to_stdout( &amp;doc ); // defined later in the tutorial<br>}<br>else<br>{<br>printf(“Failed to load file /“%s/“/n”, pFilename);<br>}<br>}</p>
<p>// ———————————————————————-<br>// main() for printing files named on the command line<br>// ———————————————————————-<br>int main(int argc, char* argv[])<br>{<br>for (int i=1; i&lt;argc; i++)<br>{<br>dump_to_stdout(argv[i]);<br>}<br>return 0;<br>}<br> </p>
<p>递归和树简直就是绝配，前阵子做等了部分加载联系人到树控件时也是用递归搞定的，有时间再把递归好好研究下。</p>
<p></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/05/30/滚动条-可滚动文字的窗口/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2009/05/30/滚动条-可滚动文字的窗口/" itemprop="url">滚动条-可滚动文字的窗口</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-05-30T21:42:00+08:00">
                2009-05-30
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/VC/" itemprop="url" rel="index">
                    <span itemprop="name">VC</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><span style="font-size: 9pt; font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size: 10.5pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;">就像玩<span lang="EN-US">War3</span>时对不死族的恐惧一样，做界面时一直都不想去涉及滚动条，借端午节狠下心来把滚动条又看了一遍，再一次印证实践才是真理，把对滚动条的理解写下来，以便于以后查阅。</span></p>
<p>&nbsp;</p>
<p><span style="font-size: small;"><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;"><img src="http://i.msdn.microsoft.com/Bb787527.csscr_02(en-us,VS.85" alt="滚动条结构">.gif)</span></span></p>
<p><span style="font-size: small;"><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;">上图是<span lang="EN-US">MSDN</span>中对滚动条的描述，很直观，而滚动条相关的消息也不多最常用的也就是</span><span style="font-size: 12pt; color: #010001; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">WM_VSCROLL</span><span style="font-size: 12pt; color: #010001; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;">和<span lang="EN-US">WM_HSCROLL</span>，</span><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;">这两个消息的</span><span style="font-size: 12pt; color: #010001; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">LOWORD</span><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"> (<span style="color: #010001;">wParam</span>)</span><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;">参数对应了一系列</span><strong><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt;" lang="EN-US">Request Code</span></strong><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;">：</span></span></p>
<table class="MsoNormalTable" style="background: white; mso-cellspacing: 1.5pt; mso-yfti-tbllook: 1184;" border="0" cellpadding="0"><br><tbody><br><tr style="mso-yfti-irow: 0; mso-yfti-firstrow: yes;"><br><td style="background: #dddddd; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><strong><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Request</span></strong><br><br></td><br><td style="background: #dddddd; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><strong><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Action</span></strong><br><br></td><br><td style="background: #dddddd; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><strong><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Response</span></strong><br><br></td><br></tr><br><tr style="mso-yfti-irow: 1;"><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_LINEUP</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user clicks the top scroll arrow.</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Decrements the scroll box position; scrolls toward the top of the data by one unit. </span><br><br></td><br></tr><br><tr style="mso-yfti-irow: 2;"><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_LINEDOWN</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user clicks the bottom scroll arrow.</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Increments the scroll box position; scrolls toward the bottom of the data by one unit. </span><br><br></td><br></tr><br><tr style="mso-yfti-irow: 3;"><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_LINELEFT</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user clicks the left scroll arrow.</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Decrements the scroll box position; scrolls toward the left end of the data by one unit. </span><br><br></td><br></tr><br><tr style="mso-yfti-irow: 4;"><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_LINERIGHT</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user clicks the right scroll arrow.</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Increments the scroll box position; scrolls toward the right end of the data by one unit. </span><br><br></td><br></tr><br><tr style="mso-yfti-irow: 5;"><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_PAGEUP</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user clicks the scroll bar shaft above the scroll box.</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Decrements the scroll box position by the number of data units in the window; scrolls toward the top of the data by the same number of units. </span><br><br></td><br></tr><br><tr style="mso-yfti-irow: 6;"><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_PAGEDOWN</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user clicks the scroll bar shaft below the scroll box.</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Increments the scroll box position by the number of data units in the window; scrolls toward the bottom of the data by the same number of units. </span><br><br></td><br></tr><br><tr style="mso-yfti-irow: 7;"><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_PAGELEFT</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user clicks the scroll bar shaft to the left of the scroll box.</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Decrements the scroll box position by the number of data units in the window; scrolls toward the left end of the data by the same number of units. </span><br><br></td><br></tr><br><tr style="mso-yfti-irow: 8;"><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_PAGERIGHT</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user clicks the scroll bar shaft to the right of the scroll box.</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Increments the scroll box position by the number of data units in the window; scrolls toward the right end of the data by the same number of units. </span><br><br></td><br></tr><br><tr style="mso-yfti-irow: 9;"><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_THUMBPOSITION</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user releases the scroll box after dragging it.</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Sets the scroll box to the position specified in the message; scrolls the data by the same number of units the scroll box has moved. </span><br><br></td><br></tr><br><tr style="mso-yfti-irow: 10;"><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_THUMBTRACK</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user drags the scroll box.</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Sets the scroll box to the position specified in the message and scrolls the data by the same number of units the scroll box has moved for applications that draw data quickly. Applications that cannot draw data quickly must wait for the SB_THUMBPOSITION request code before moving the scroll box and scrolling the data. </span><br><br></td><br></tr><br><tr style="mso-yfti-irow: 11; mso-yfti-lastrow: yes;"><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_ENDSCROLL</span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user releases the mouse after holding it on an arrow or in the scroll bar shaft. </span><br><br></td><br><td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top"><br><br><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">No response is needed. </span><br><br></td><br></tr><br></tbody><br></table>

<p><span style="font-size: small;"><strong><span style="color: red; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;" lang="EN-US">1</span>**</strong><span style="color: red; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;">设置滚动条参数</span>**</span></p>
<p><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;"><span style="font-size: small;">一般都是在<span lang="EN-US">WM_SIZE</span>消息中设置滚动条的信息，这样当窗口大小变化时滚动条可以做相应的改变，以显示或者隐藏之或者改变其<span lang="EN-US">ScrollBox</span>的大小。</span></span></p>
<p><span style="font-size: small;"><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;" lang="EN-US">MSDN</span><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;">上面有一段说道滚动条的显示问题：</span></span></p>
<p><strong><span style="font-size: 10pt; font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: 宋体; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Scroll Bar Visibility</span></strong></p>
<p><strong><span style="font-size: 9pt; color: red; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The system hides and disables a standard scroll bar when equal minimum and maximum values are specified. The system also hides and disables a standard scroll bar if you specify a page size that includes the entire scroll range of the scroll bar. This is the way to temporarily hide a scroll bar when it is not needed for the content of the client area.</span></strong><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US"> There is no need to make scrolling requests through the scroll bar when it is hidden. The system enables the scroll bar and shows it again when you set the minimum and maximum values to unequal values or when the page size that does not include the entire scroll range. The ShowScrollBar function can also be used to hide or show a scroll bar. It does not affect the scroll bar’s range, page size, or scroll box position. </span></p>
<p><span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The EnableScrollBar function can be used to disable one or both arrows of a scroll bar. An application displays disabled arrows in gray and does not respond to user input. </span></p>
<p><span style="font-size: small;"><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;">红色标记的地方说道，系统会在两种情况下隐藏并禁用滚动条，</span><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt;" lang="EN-US">1</span><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt;">是在</span><span style="color: #010001; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">SCROLLINFO</span><span style="color: #010001; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;">中的<span lang="EN-US">nMin</span></span><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">==<span style="color: #010001;">nMax</span></span><span style="color: #010001; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;">时，由于最小滚动位置和最大滚动位置相等当然没有必要显示滚动条了，<span lang="EN-US">2</span>是在指定的<span lang="EN-US">nPage</span>，也就是当前窗口客户区可以显示的单位数据的大小，包含整个滚动范围<span lang="EN-US">,</span>这时当前客户区可以显示所有的数据，因此不需要滚动条。<span lang="EN-US">MSDN</span>上面是这样描述<span lang="EN-US">page size</span>的：</span></span></p>
<p><span style="font-size: small;"><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">page size</span><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;">代表滚动条的<span lang="EN-US">Ower</span>窗口的当前客户区大小可以容纳单位数据的大小，例如如果客户区可以容纳<span lang="EN-US">16</span>行文字，那么应该将<span lang="EN-US">page size</span>设置为<span lang="EN-US">16</span>，系统使用<span lang="EN-US">page size</span>，以及滚动范围以及滚动条长度，来设置<span lang="EN-US">scroll box</span>的大小，当一个包含滚动条的窗口改变大小时，应该通过<span lang="EN-US">SetScrollInfo</span>设置<span lang="EN-US">page size</span>。</span></span></p>
<p><span style="font-size: small;"><strong><span style="color: red; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">2</span>**</strong><span style="color: red; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;">滚动窗口</span>**</span></p>
<p><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;"><span style="font-size: small;">进行窗口滚动的操作是在<span style="color: #010001;" lang="EN-US">WM_VSCROLL</span><span style="color: #010001;">或者<span lang="EN-US">WM_HSCROLL</span>中完成的，先根据相应的<span lang="EN-US">Request Code</span>对<span lang="EN-US">nPos</span>进行调整，然后调用</span><span lang="EN-US">SetScrollInfo</span>对<span lang="EN-US">nPos</span>这一项进行调整，之后通过<span style="color: #010001;" lang="EN-US">ScrollWindowEx</span><span style="color: #010001;">滚动窗口，根据<span lang="EN-US">MSDN</span>上面的例子可以看出，先保存先前的<span lang="EN-US">nPos</span>，然后用调整后的<span lang="EN-US">nPos</span>与之想减，再乘上水平或者垂直方向的单位尺寸，即为滚动的区域。</span></span></span></p>
<p><span style="font-size: small;"><strong><span style="color: red; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">3</span>**</strong><span style="color: red; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;">滚动后可见的窗口区域的绘制</span>**</span></p>
<p><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;"><span style="font-size: small;">当窗口滚动后，面对的首要问题就是如何显示之前不可见现在可见的区域，对于滚动文字，需要处理当然是需要<span lang="EN-US">WM_PAINT</span>了。这里看得不是很懂，但是通过<span lang="EN-US">TRACE</span>可以发现的是<span lang="EN-US">WM_PAINT</span>确实是在<span lang="EN-US">Invalide</span>区域中重绘，当单击垂直滚动条的三角按钮时系统只重绘一行文字，具体方法可以看下面的源码。</span></span></p>
<p><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;"><span style="font-size: small;">下面的源码是<span lang="EN-US">MSDN</span>的例子：</span></span></p>
<p><span style="font-size: 12pt; color: #010001; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">LRESULT</span><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"> <span style="color: #010001;">CALLBACK</span> <span style="color: #010001;">WndProc</span>(<span style="color: #010001;">HWND</span> <span style="color: #010001;">hWnd</span>, <span style="color: #010001;">UINT</span> <span style="color: #010001;">message</span>, <span style="color: #010001;">WPARAM</span> <span style="color: #010001;">wParam</span>, <span style="color: #010001;">LPARAM</span> <span style="color: #010001;">lParam</span>)</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">{</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span> <span style="color: #010001;">wmId</span>, <span style="color: #010001;">wmEvent</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">//////////////////////////////////////////////////////////////////////////</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">HDC</span> <span style="color: #010001;">hdc</span>; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PAINTSTRUCT</span> <span style="color: #010001;">ps</span>; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXTMETRIC</span> <span style="color: #010001;">tm</span>; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SCROLLINFO</span> <span style="color: #010001;">si</span>; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// These variables are required to display text. </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span> <span style="color: #010001;">xClient</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// width of client area </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span> <span style="color: #010001;">yClient</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// height of client area </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span> <span style="color: #010001;">xClientMax</span>;<span style="mso-spacerun: yes;">&nbsp; </span><span style="color: green;">// maximum width of client area </span></span></p>
<p><span style="font-size: 12pt; color: green; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span> <span style="color: #010001;">xChar</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// horizontal scrolling unit </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span> <span style="color: #010001;">yChar</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// vertical scrolling unit </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span> <span style="color: #010001;">xUpper</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// average width of uppercase letters </span></span></p>
<p><span style="font-size: 12pt; color: green; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span> <span style="color: #010001;">xPos</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// current horizontal scrolling position </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span> <span style="color: #010001;">yPos</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// current vertical scrolling position </span></span></p>
<p><span style="font-size: 12pt; color: green; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span> <span style="color: #010001;">i</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// loop counter </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span> <span style="color: #010001;">x</span>, <span style="color: #010001;">y</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// horizontal and vertical coordinates</span></span></p>
<p><span style="font-size: 12pt; color: green; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span> <span style="color: #010001;">FirstLine</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// first line in the invalidated area </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span> <span style="color: #010001;">LastLine</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// last line in the invalidated area </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">HRESULT</span> <span style="color: #010001;">hr</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">size_t</span><span style="mso-spacerun: yes;">&nbsp; </span><span style="color: #010001;">abcLength</span>=0;<span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// length of an abc[] item</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Create an array of lines to display. </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">#define</span> <span style="color: #010001;">LINES</span> 28 </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: #010001;">TCHAR</span> *<span style="color: #010001;">abc</span>[] = { </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“anteater”</span>),<span style="mso-spacerun: yes;">&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“bear”</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“cougar”</span>), </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“dingo”</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“elephant”</span>),<span style="mso-spacerun: yes;">&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“falcon”</span>), </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“gazelle”</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“hyena”</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“iguana”</span>), </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“jackal”</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“kangaroo”</span>),<span style="mso-spacerun: yes;">&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“llama”</span>), </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“moose”</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“newt”</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“octopus”</span>), </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“penguin”</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“quail”</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“rat”</span>), </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“squid”</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“tortoise”</span>),<span style="mso-spacerun: yes;">&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“urus”</span>), </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“vole”</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“walrus”</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“xylophone”</span>), </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“yak”</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“zebra”</span>),</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“This line contains words, but no character. Go figure.”</span>),</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">“”</span>)</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">//////////////////////////////////////////////////////////////////////////</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">switch</span> (<span style="color: #010001;">message</span>)</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_CREATE</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">CreateWindowEx</span>( </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0L,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// no extended styles </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">_T</span>(<span style="color: #a31515;">“SCROLLBAR”</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// scroll bar control class </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(<span style="color: #010001;">LPCWSTR</span>) <span style="color: #010001;">NULL</span>,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// text for window title bar </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">WS_CHILD</span> | <span style="color: #010001;">SBS_HORZ</span>,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// scroll bar styles </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// horizontal position </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// vertical position </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>200,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// width of the scroll bar </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>50,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// default height </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hWnd</span>,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// handle to main window </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(<span style="color: #010001;">HMENU</span>) <span style="color: #010001;">NULL</span>,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// no menu for a scroll bar </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hInst</span>,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// instance owning this window </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(<span style="color: #010001;">LPVOID</span>) <span style="color: #010001;">NULL</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// pointer not needed </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>); </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">//////////////////////////////////////////////////////////////////////////</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Get the handle to the client area’s device context. </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hdc</span> = <span style="color: #010001;">GetDC</span> (<span style="color: #010001;">hWnd</span>); </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Extract font dimensions from the text metrics. </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">GetTextMetrics</span> (<span style="color: #010001;">hdc</span>, &amp;<span style="color: #010001;">tm</span>); </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">xChar</span> = <span style="color: #010001;">tm</span>.<span style="color: #010001;">tmAveCharWidth</span>; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">xUpper</span> = (<span style="color: #010001;">tm</span>.<span style="color: #010001;">tmPitchAndFamily</span> &amp; 1 ? 3 : 2) * <span style="color: #010001;">xChar</span>/2; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">yChar</span> = <span style="color: #010001;">tm</span>.<span style="color: #010001;">tmHeight</span> + <span style="color: #010001;">tm</span>.<span style="color: #010001;">tmExternalLeading</span>; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Free the device context. </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ReleaseDC</span> (<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">hdc</span>); </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Set an arbitrary maximum width for client area. </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// (xClientMax is the sum of the widths of 48 average </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// lowercase letters and 12 uppercase letters.) </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">xClientMax</span> = 48 <em> <span style="color: #010001;">xChar</span> + 12 </em> <span style="color: #010001;">xUpper</span>; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">//////////////////////////////////////////////////////////////////////////</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_COMMAND</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wmId</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">LOWORD</span>(<span style="color: #010001;">wParam</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wmEvent</span> = <span style="color: #010001;">HIWORD</span>(<span style="color: #010001;">wParam</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// </span></span><span style="font-size: 12pt; color: green; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;">分析菜单选择<span lang="EN-US">:</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">switch</span> (<span style="color: #010001;">wmId</span>)</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">IDM_ABOUT</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DialogBox</span>(<span style="color: #010001;">hInst</span>, <span style="color: #010001;">MAKEINTRESOURCE</span>(<span style="color: #010001;">IDD_ABOUTBOX</span>), <span style="color: #010001;">hWnd</span>, <span style="color: #010001;">About</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">IDM_EXIT</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DestroyWindow</span>(<span style="color: #010001;">hWnd</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">default</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> <span style="color: #010001;">DefWindowProc</span>(<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">message</span>, <span style="color: #010001;">wParam</span>, <span style="color: #010001;">lParam</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_SIZE</span>: </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Retrieve the dimensions of the client area. </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">yClient</span> = <span style="color: #010001;">HIWORD</span> (<span style="color: #010001;">lParam</span>); </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">xClient</span> = <span style="color: #010001;">LOWORD</span> (<span style="color: #010001;">lParam</span>); </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Set the vertical scrolling range and page size</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">cbSize</span> = <span style="color: blue;">sizeof</span>(<span style="color: #010001;">si</span>); </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">fMask</span><span style="mso-spacerun: yes;">&nbsp; </span>= <span style="color: #010001;">SIF_RANGE</span> | <span style="color: #010001;">SIF_PAGE</span>; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nMin</span><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>= 0; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nMax</span><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>= <span style="color: #010001;">LINES</span> - 1; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPage</span><span style="mso-spacerun: yes;">&nbsp; </span>= <span style="color: #010001;">yClient</span> / <span style="color: #010001;">yChar</span>; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetScrollInfo</span>(<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_VERT</span>, &amp;<span style="color: #010001;">si</span>, <span style="color: #010001;">TRUE</span>); </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Set the horizontal scrolling range and page size. </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">cbSize</span> = <span style="color: blue;">sizeof</span>(<span style="color: #010001;">si</span>); </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">fMask</span><span style="mso-spacerun: yes;">&nbsp; </span>= <span style="color: #010001;">SIF_RANGE</span> | <span style="color: #010001;">SIF_PAGE</span>; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nMin</span><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>= 0; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nMax</span><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>= 2 + <span style="color: #010001;">xClientMax</span> / <span style="color: #010001;">xChar</span>; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPage</span><span style="mso-spacerun: yes;">&nbsp; </span>= <span style="color: #010001;">xClient</span> / <span style="color: #010001;">xChar</span>; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetScrollInfo</span>(<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_HORZ</span>, &amp;<span style="color: #010001;">si</span>, <span style="color: #010001;">TRUE</span>); </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_HSCROLL</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Get all the vertial scroll bar information</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">cbSize</span> = <span style="color: blue;">sizeof</span> (<span style="color: #010001;">si</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">fMask</span><span style="mso-spacerun: yes;">&nbsp; </span>= <span style="color: #010001;">SIF_ALL</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Save the position for comparison later on</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">GetScrollInfo</span> (<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_HORZ</span>, &amp;<span style="color: #010001;">si</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">xPos</span> = <span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">switch</span> (<span style="color: #010001;">LOWORD</span> (<span style="color: #010001;">wParam</span>))</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked left arrow</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_LINELEFT</span>: </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> -= 1;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked right arrow</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_LINERIGHT</span>: </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> += 1;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked the scroll bar shaft left of the scroll box</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_PAGELEFT</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> -= <span style="color: #010001;">si</span>.<span style="color: #010001;">nPage</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked the scroll bar shaft right of the scroll box</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_PAGERIGHT</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> += <span style="color: #010001;">si</span>.<span style="color: #010001;">nPage</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user dragged the scroll box</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_THUMBTRACK</span>: </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> = <span style="color: #010001;">si</span>.<span style="color: #010001;">nTrackPos</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">default</span> :</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Set the position and then retrieve it.<span style="mso-spacerun: yes;">&nbsp; </span>Due to adjustments</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">//<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>by Windows it may not be the same as the value set.</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">fMask</span> = <span style="color: #010001;">SIF_POS</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetScrollInfo</span> (<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_HORZ</span>, &amp;<span style="color: #010001;">si</span>, <span style="color: #010001;">TRUE</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">GetScrollInfo</span> (<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_HORZ</span>, &amp;<span style="color: #010001;">si</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// If the position has changed, scroll the window </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (<span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> != <span style="color: #010001;">xPos</span>)</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ScrollWindowEx</span>(<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">xChar</span> * (<span style="color: #010001;">xPos</span> - <span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span>), 0, <span style="color: #010001;">NULL</span>, <span style="color: #010001;">NULL</span>,</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;</span><span style="color: #010001;">NULL</span>, <span style="color: #010001;">NULL</span>,<span style="color: #010001;">SW_INVALIDATE</span>|<span style="color: #010001;">SW_ERASE</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">//ScrollWindow(hWnd, xChar * (xPos - si.nPos), 0, NULL, NULL);</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_VSCROLL</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Get all the vertial scroll bar information</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">cbSize</span> = <span style="color: blue;">sizeof</span> (<span style="color: #010001;">si</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">fMask</span><span style="mso-spacerun: yes;">&nbsp; </span>= <span style="color: #010001;">SIF_ALL</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">GetScrollInfo</span> (<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_VERT</span>, &amp;<span style="color: #010001;">si</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Save the position for comparison later on</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">yPos</span> = <span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">switch</span> (<span style="color: #010001;">LOWORD</span> (<span style="color: #010001;">wParam</span>))</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked the HOME keyboard key</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_TOP</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> = <span style="color: #010001;">si</span>.<span style="color: #010001;">nMin</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked the END keyboard key</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_BOTTOM</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> = <span style="color: #010001;">si</span>.<span style="color: #010001;">nMax</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked the top arrow</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_LINEUP</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> -= 1;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked the bottom arrow</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_LINEDOWN</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> += 1;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked the scroll bar shaft above the scroll box</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_PAGEUP</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> -= <span style="color: #010001;">si</span>.<span style="color: #010001;">nPage</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked the scroll bar shaft below the scroll box</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_PAGEDOWN</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> += <span style="color: #010001;">si</span>.<span style="color: #010001;">nPage</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user dragged the scroll box</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_THUMBTRACK</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> = <span style="color: #010001;">si</span>.<span style="color: #010001;">nTrackPos</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">default</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>; </span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Set the position and then retrieve it.<span style="mso-spacerun: yes;">&nbsp; </span>Due to adjustments</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">//<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>by Windows it may not be the same as the value set.</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">fMask</span> = <span style="color: #010001;">SIF_POS</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetScrollInfo</span> (<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_VERT</span>, &amp;<span style="color: #010001;">si</span>, <span style="color: #010001;">TRUE</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">GetScrollInfo</span> (<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_VERT</span>, &amp;<span style="color: #010001;">si</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// If the position has changed, scroll window and update it</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (<span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> != <span style="color: #010001;">yPos</span>)</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ScrollWindow</span>(<span style="color: #010001;">hWnd</span>, 0, <span style="color: #010001;">yChar</span> * (<span style="color: #010001;">yPos</span> - <span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span>), <span style="color: #010001;">NULL</span>, <span style="color: #010001;">NULL</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">UpdateWindow</span> (<span style="color: #010001;">hWnd</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_PAINT</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Prepare the window for painting</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hdc</span> = <span style="color: #010001;">BeginPaint</span> (<span style="color: #010001;">hWnd</span>, &amp;<span style="color: #010001;">ps</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Get vertical scroll bar position</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">cbSize</span> = <span style="color: blue;">sizeof</span> (<span style="color: #010001;">si</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">fMask</span><span style="mso-spacerun: yes;">&nbsp; </span>= <span style="color: #010001;">SIF_POS</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">GetScrollInfo</span> (<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_VERT</span>, &amp;<span style="color: #010001;">si</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">yPos</span> = <span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Get horizontal scroll bar position</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">GetScrollInfo</span> (<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_HORZ</span>, &amp;<span style="color: #010001;">si</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">xPos</span> = <span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Find painting limits</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">FirstLine</span> = <span style="color: #010001;">max</span> (0, <span style="color: #010001;">yPos</span> + <span style="color: #010001;">ps</span>.<span style="color: #010001;">rcPaint</span>.<span style="color: #010001;">top</span> / <span style="color: #010001;">yChar</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">LastLine</span> = <span style="color: #010001;">min</span> (<span style="color: #010001;">LINES</span> - 1, <span style="color: #010001;">yPos</span> + <span style="color: #010001;">ps</span>.<span style="color: #010001;">rcPaint</span>.<span style="color: #010001;">bottom</span> / <span style="color: #010001;">yChar</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">sprintf</span>(<span style="color: #010001;">szDebug</span>,(<span style="color: #a31515;">“%d,%d,%d,%d/r/n”</span>),<span style="color: #010001;">ps</span>.<span style="color: #010001;">rcPaint</span>.<span style="color: #010001;">left</span>,<span style="color: #010001;">ps</span>.<span style="color: #010001;">rcPaint</span>.<span style="color: #010001;">top</span>,<span style="color: #010001;">ps</span>.<span style="color: #010001;">rcPaint</span>.<span style="color: #010001;">right</span>,<span style="color: #010001;">ps</span>.<span style="color: #010001;">rcPaint</span>.<span style="color: #010001;">bottom</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">OutputDebugStringA</span>(<span style="color: #010001;">szDebug</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ZeroMemory</span>(<span style="color: #010001;">szDebug</span>,0);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">sprintf</span>(<span style="color: #010001;">szDebug</span>,<span style="color: #a31515;">“FirstLine=%d,LastLine=%d/r/n”</span>,<span style="color: #010001;">FirstLine</span>,<span style="color: #010001;">LastLine</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">OutputDebugStringA</span>(<span style="color: #010001;">szDebug</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">for</span> (<span style="color: #010001;">i</span> = <span style="color: #010001;">FirstLine</span>; <span style="color: #010001;">i</span> &lt;= <span style="color: #010001;">LastLine</span>; <span style="color: #010001;">i</span>++)</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">x</span> = <span style="color: #010001;">xChar</span> * (1 - <span style="color: #010001;">xPos</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">y</span> = <span style="color: #010001;">yChar</span> * (<span style="color: #010001;">i</span> - <span style="color: #010001;">yPos</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Note that “55” in the following depends on the </span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// maximum size of an abc[] item.</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">//</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hr</span> = <span style="color: #010001;">StringCchLength</span>(<span style="color: #010001;">abc</span>[<span style="color: #010001;">i</span>], 100, &amp;<span style="color: #010001;">abcLength</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> ((<span style="color: #010001;">FAILED</span>(<span style="color: #010001;">hr</span>)) | (&amp;<span style="color: #010001;">abcLength</span> == <span style="color: #010001;">NULL</span>))</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">/<em>MessageBox(hWnd,_T(“</em></span></span><span style="font-size: 12pt; color: green; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;">字符串长度为<span lang="EN-US">!”),_T(“</span>错误<span lang="EN-US">“),MB_ICONERROR);/</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">else</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TextOut</span>(<span style="color: #010001;">hdc</span>,<span style="color: #010001;">x</span>,<span style="color: #010001;">y</span>,<span style="color: #010001;">abc</span>[<span style="color: #010001;">i</span>],<span style="color: #010001;">abcLength</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Indicate that painting is finished</span></span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">EndPaint</span> (<span style="color: #010001;">hWnd</span>, &amp;<span style="color: #010001;">ps</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_DESTROY</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PostQuitMessage</span>(0);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">default</span>:</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> <span style="color: #010001;">DefWindowProc</span>(<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">message</span>, <span style="color: #010001;">wParam</span>, <span style="color: #010001;">lParam</span>);</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0;</span></p>
<p><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">}</span></p>
<p></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/9/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/11/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">billowqiu</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">155</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">31</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/billowqiu" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:billowqiu@163.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">billowqiu</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
