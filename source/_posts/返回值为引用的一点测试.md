---
title: 返回值为引用的一点测试
id: 142
categories:
  - C++
date: 2009-08-25 22:10:00
tags:
---

    

最近做多人视频时设计了一个简单的类，但是简单的类也很能说明问题，也再次说明有些基础知识还是理解得不够深刻，刚写了个测试程序以便日后查阅，主要是关于返回值为引用类型时的一点测试:

<pre style="border: 1px dotted #785;background: #f5f5f5;">#include &lt;iostream&gt;
using namespace std;

class CConstRef
{
public:
CConstRef(int iA):m_iA(iA)
{
}
const int&amp; GetA()const
{
return m_iA;
}
int&amp; GetA()
{
return m_iA;
}
void PrintAddress()const
{
cout&lt;&lt;"Address of m_iA = "&lt;&lt;&amp;m_iA&lt;&lt;endl;
}
private:
int m_iA;
};

int main(int argc, char* argv[])
{
//常量对象
const CConstRef cCA(8);
//非常量对象
CConstRef CA(9);
//////////////////////////////////////////////////////////////////////////
//注意下面的调用都是返回对象cCA的成员m_iA的引用,且此引用都是用来初始化另一引用
//因此地址都相同
//调用int&amp; GetA()
int&amp; ra = CA.GetA();
CA.PrintAddress();
cout&lt;&lt;"Address of ra = "&lt;&lt;&amp;ra&lt;&lt;endl;
ra = 3;
cout&lt;&lt;"Now the CA.m_iA = "&lt;&lt;CA.GetA()&lt;&lt;endl;

//调用int&amp; GetA()
const int&amp; ra1 = CA.GetA();
cout&lt;&lt;"Address of ra1 = "&lt;&lt;&amp;ra1&lt;&lt;endl;
//////////////////////////////////////////////////////////////////////////
//调用int&amp; GetA()
int va = CA.GetA();
CA.PrintAddress();
cout&lt;&lt;"Address of va = "&lt;&lt;&amp;va&lt;&lt;endl;
va = 3;
cout&lt;&lt;"Now the CA.m_iA = "&lt;&lt;CA.GetA()&lt;&lt;endl;

//调用int&amp; GetA()
const int va1 = CA.GetA();
cout&lt;&lt;"Address of va1 = "&lt;&lt;&amp;va1&lt;&lt;endl;
//////////////////////////////////////////////////////////////////////////
//下面的rb就是cCA.m_iA
const int&amp; rb = cCA.GetA();

cCA.PrintAddress();
cout&lt;&lt;"Address of rb = "&lt;&lt;&amp;rb&lt;&lt;endl;

/*
error: invalid initialization of reference of type 'int&amp;' from expression of type 'const int'
上面的错误时G++提示的，这么说来其实编译器给我们返回的是const int而不是const int&amp;
*/
// int&amp; rb1 = cCA.GetA();

//下面的的vb和vb1都是是cCA.m_iA的一个副本
const int vb = cCA.GetA();
cout&lt;&lt;"Address of vb = "&lt;&lt;&amp;vb&lt;&lt;endl;

int vb1 = cCA.GetA();
cout&lt;&lt;"Address of vb1 = "&lt;&lt;&amp;vb1&lt;&lt;endl;
vb1 = 10;

cout&lt;&lt;"Now the cCA.m_iA = "&lt;&lt;cCA.GetA()&lt;&lt;endl;

return 0;
}
</pre> 

下面是在MinGW的G++下输出的结果

![返回引用](http://p.blog.csdn.net/images/p_blog_csdn_net/ToCpp/EntryImages/20090825/Result.PNG "返回引用")

&nbsp;

> &nbsp;
> 
> <span style="background-color: #ff0000;"><span style="color: #00ff00;"><span style="background-color: #ffffff;">**路路漫漫其修远兮，吾将上下而求索！**</span></span></span>
</div>