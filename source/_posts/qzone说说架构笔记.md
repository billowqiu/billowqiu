---
title: qzone说说架构笔记
id: 676
categories:
  - 未分类
date: 2013-09-09 00:05:09
tags:
---

今天听了QZone说说部分的架构分享，是这个系列分享迄今为止干货最多的一次，分享者讲得比较快，但是都很实在，个人觉得主要有以下几点值得学习：

1.  对CAP的应用，说说选择了AP，对于C是最终一致，大多数互联网系统应该都是这样
2.  削峰填谷，主要是每年除夕，元旦等高峰期请求量暴涨，这个时候如果只是盲目的进行扩容是不太合适的，通过类似队列方式进行异步处理是比较好的削峰手段(新浪微博计数服务采用这个)，由于说说属于UGC性质，用户对实时性和准确性要求较高，采用的是一个单独的cache服务，且只会在判断为高峰期才会自动打开
3.  高峰期时的柔性可用，有选择的舍弃一些不太重要的服务，比如同步到个性签名，微博等
4.  数据存储结构（按uin存，每个uin最多保留3条记录），这个方案跟最近我遇到的一个问题类似，不过我最后还是采取的按照session来存数据