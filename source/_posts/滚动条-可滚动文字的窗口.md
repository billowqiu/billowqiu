---
title: 滚动条-可滚动文字的窗口
id: 153
categories:
  - VC
date: 2009-05-30 21:42:00
tags:
---

    

<span style="font-size: 9pt; font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size: 10.5pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;">就像玩<span lang="EN-US">War3</span>时对不死族的恐惧一样，做界面时一直都不想去涉及滚动条，借端午节狠下心来把滚动条又看了一遍，再一次印证实践才是真理，把对滚动条的理解写下来，以便于以后查阅。</span>

&nbsp;

<span style="font-size: small;"><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;">![滚动条结构](http://i.msdn.microsoft.com/Bb787527.csscr_02(en-us,VS.85).gif)</span></span>

<span style="font-size: small;"><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;">上图是<span lang="EN-US">MSDN</span>中对滚动条的描述，很直观，而滚动条相关的消息也不多最常用的也就是</span><span style="font-size: 12pt; color: #010001; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">WM_VSCROLL</span><span style="font-size: 12pt; color: #010001; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;">和<span lang="EN-US">WM_HSCROLL</span>，</span><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;">这两个消息的</span><span style="font-size: 12pt; color: #010001; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">LOWORD</span><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"> (<span style="color: #010001;">wParam</span>)</span><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;">参数对应了一系列</span>**<span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt;" lang="EN-US">Request Code</span>**<span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;">：</span></span>

<table class="MsoNormalTable" style="background: white; mso-cellspacing: 1.5pt; mso-yfti-tbllook: 1184;" border="0" cellpadding="0">
<tbody>
<tr style="mso-yfti-irow: 0; mso-yfti-firstrow: yes;">
<td style="background: #dddddd; border: #c0c0c0; padding: 1.5pt;" valign="top">

**<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Request</span>**

</td>
<td style="background: #dddddd; border: #c0c0c0; padding: 1.5pt;" valign="top">

**<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Action</span>**

</td>
<td style="background: #dddddd; border: #c0c0c0; padding: 1.5pt;" valign="top">

**<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Response</span>**

</td>
</tr>
<tr style="mso-yfti-irow: 1;">
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_LINEUP</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user clicks the top scroll arrow.</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Decrements the scroll box position; scrolls toward the top of the data by one unit. </span>

</td>
</tr>
<tr style="mso-yfti-irow: 2;">
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_LINEDOWN</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user clicks the bottom scroll arrow.</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Increments the scroll box position; scrolls toward the bottom of the data by one unit. </span>

</td>
</tr>
<tr style="mso-yfti-irow: 3;">
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_LINELEFT</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user clicks the left scroll arrow.</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Decrements the scroll box position; scrolls toward the left end of the data by one unit. </span>

</td>
</tr>
<tr style="mso-yfti-irow: 4;">
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_LINERIGHT</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user clicks the right scroll arrow.</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Increments the scroll box position; scrolls toward the right end of the data by one unit. </span>

</td>
</tr>
<tr style="mso-yfti-irow: 5;">
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_PAGEUP</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user clicks the scroll bar shaft above the scroll box.</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Decrements the scroll box position by the number of data units in the window; scrolls toward the top of the data by the same number of units. </span>

</td>
</tr>
<tr style="mso-yfti-irow: 6;">
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_PAGEDOWN</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user clicks the scroll bar shaft below the scroll box.</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Increments the scroll box position by the number of data units in the window; scrolls toward the bottom of the data by the same number of units. </span>

</td>
</tr>
<tr style="mso-yfti-irow: 7;">
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_PAGELEFT</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user clicks the scroll bar shaft to the left of the scroll box.</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Decrements the scroll box position by the number of data units in the window; scrolls toward the left end of the data by the same number of units. </span>

</td>
</tr>
<tr style="mso-yfti-irow: 8;">
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_PAGERIGHT</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user clicks the scroll bar shaft to the right of the scroll box.</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Increments the scroll box position by the number of data units in the window; scrolls toward the right end of the data by the same number of units. </span>

</td>
</tr>
<tr style="mso-yfti-irow: 9;">
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_THUMBPOSITION</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user releases the scroll box after dragging it.</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Sets the scroll box to the position specified in the message; scrolls the data by the same number of units the scroll box has moved. </span>

</td>
</tr>
<tr style="mso-yfti-irow: 10;">
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_THUMBTRACK</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user drags the scroll box.</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Sets the scroll box to the position specified in the message and scrolls the data by the same number of units the scroll box has moved for applications that draw data quickly. Applications that cannot draw data quickly must wait for the SB_THUMBPOSITION request code before moving the scroll box and scrolling the data. </span>

</td>
</tr>
<tr style="mso-yfti-irow: 11; mso-yfti-lastrow: yes;">
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">SB_ENDSCROLL</span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The user releases the mouse after holding it on an arrow or in the scroll bar shaft. </span>

</td>
<td style="background: #eeeeee; border: #c0c0c0; padding: 1.5pt;" valign="top">

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">No response is needed. </span>

</td>
</tr>
</tbody>
</table>

<span style="font-size: small;">**<span style="color: red; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;" lang="EN-US">1</span>****<span style="color: red; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;">设置滚动条参数</span>**</span>

<span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;"><span style="font-size: small;">一般都是在<span lang="EN-US">WM_SIZE</span>消息中设置滚动条的信息，这样当窗口大小变化时滚动条可以做相应的改变，以显示或者隐藏之或者改变其<span lang="EN-US">ScrollBox</span>的大小。</span></span>

<span style="font-size: small;"><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;" lang="EN-US">MSDN</span><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;">上面有一段说道滚动条的显示问题：</span></span>

**<span style="font-size: 10pt; font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: 宋体; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Scroll Bar Visibility</span>**

**<span style="font-size: 9pt; color: red; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The system hides and disables a standard scroll bar when equal minimum and maximum values are specified. The system also hides and disables a standard scroll bar if you specify a page size that includes the entire scroll range of the scroll bar. This is the way to temporarily hide a scroll bar when it is not needed for the content of the client area.</span>**<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US"> There is no need to make scrolling requests through the scroll bar when it is hidden. The system enables the scroll bar and shows it again when you set the minimum and maximum values to unequal values or when the page size that does not include the entire scroll range. The ShowScrollBar function can also be used to hide or show a scroll bar. It does not affect the scroll bar's range, page size, or scroll box position. </span>

<span style="font-size: 9pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">The EnableScrollBar function can be used to disable one or both arrows of a scroll bar. An application displays disabled arrows in gray and does not respond to user input. </span>

<span style="font-size: small;"><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;;">红色标记的地方说道，系统会在两种情况下隐藏并禁用滚动条，</span><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt;" lang="EN-US">1</span><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt;">是在</span><span style="color: #010001; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">SCROLLINFO</span><span style="color: #010001; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;">中的<span lang="EN-US">nMin</span></span><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">==<span style="color: #010001;">nMax</span></span><span style="color: #010001; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;">时，由于最小滚动位置和最大滚动位置相等当然没有必要显示滚动条了，<span lang="EN-US">2</span>是在指定的<span lang="EN-US">nPage</span>，也就是当前窗口客户区可以显示的单位数据的大小，包含整个滚动范围<span lang="EN-US">,</span>这时当前客户区可以显示所有的数据，因此不需要滚动条。<span lang="EN-US">MSDN</span>上面是这样描述<span lang="EN-US">page size</span>的：</span></span>

<span style="font-size: small;"><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">page size</span><span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;">代表滚动条的<span lang="EN-US">Ower</span>窗口的当前客户区大小可以容纳单位数据的大小，例如如果客户区可以容纳<span lang="EN-US">16</span>行文字，那么应该将<span lang="EN-US">page size</span>设置为<span lang="EN-US">16</span>，系统使用<span lang="EN-US">page size</span>，以及滚动范围以及滚动条长度，来设置<span lang="EN-US">scroll box</span>的大小，当一个包含滚动条的窗口改变大小时，应该通过<span lang="EN-US">SetScrollInfo</span>设置<span lang="EN-US">page size</span>。</span></span>

<span style="font-size: small;">**<span style="color: red; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">2</span>****<span style="color: red; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;">滚动窗口</span>**</span>

<span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;"><span style="font-size: small;">进行窗口滚动的操作是在<span style="color: #010001;" lang="EN-US">WM_VSCROLL</span><span style="color: #010001;">或者<span lang="EN-US">WM_HSCROLL</span>中完成的，先根据相应的<span lang="EN-US">Request Code</span>对<span lang="EN-US">nPos</span>进行调整，然后调用</span><span lang="EN-US">SetScrollInfo</span>对<span lang="EN-US">nPos</span>这一项进行调整，之后通过<span style="color: #010001;" lang="EN-US">ScrollWindowEx</span><span style="color: #010001;">滚动窗口，根据<span lang="EN-US">MSDN</span>上面的例子可以看出，先保存先前的<span lang="EN-US">nPos</span>，然后用调整后的<span lang="EN-US">nPos</span>与之想减，再乘上水平或者垂直方向的单位尺寸，即为滚动的区域。</span></span></span>

<span style="font-size: small;">**<span style="color: red; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">3</span>****<span style="color: red; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;">滚动后可见的窗口区域的绘制</span>**</span>

<span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;"><span style="font-size: small;">当窗口滚动后，面对的首要问题就是如何显示之前不可见现在可见的区域，对于滚动文字，需要处理当然是需要<span lang="EN-US">WM_PAINT</span>了。这里看得不是很懂，但是通过<span lang="EN-US">TRACE</span>可以发现的是<span lang="EN-US">WM_PAINT</span>确实是在<span lang="EN-US">Invalide</span>区域中重绘，当单击垂直滚动条的三角按钮时系统只重绘一行文字，具体方法可以看下面的源码。</span></span>

<span style="font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 10.5pt; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;"><span style="font-size: small;">下面的源码是<span lang="EN-US">MSDN</span>的例子：</span></span>

<span style="font-size: 12pt; color: #010001; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">LRESULT</span><span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"> <span style="color: #010001;">CALLBACK</span> <span style="color: #010001;">WndProc</span>(<span style="color: #010001;">HWND</span> <span style="color: #010001;">hWnd</span>, <span style="color: #010001;">UINT</span> <span style="color: #010001;">message</span>, <span style="color: #010001;">WPARAM</span> <span style="color: #010001;">wParam</span>, <span style="color: #010001;">LPARAM</span> <span style="color: #010001;">lParam</span>)</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">{</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span> <span style="color: #010001;">wmId</span>, <span style="color: #010001;">wmEvent</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">//////////////////////////////////////////////////////////////////////////</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">HDC</span> <span style="color: #010001;">hdc</span>; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PAINTSTRUCT</span> <span style="color: #010001;">ps</span>; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXTMETRIC</span> <span style="color: #010001;">tm</span>; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SCROLLINFO</span> <span style="color: #010001;">si</span>; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// These variables are required to display text. </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span> <span style="color: #010001;">xClient</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// width of client area </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span> <span style="color: #010001;">yClient</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// height of client area </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span> <span style="color: #010001;">xClientMax</span>;<span style="mso-spacerun: yes;">&nbsp; </span><span style="color: green;">// maximum width of client area </span></span>

<span style="font-size: 12pt; color: green; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span> <span style="color: #010001;">xChar</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// horizontal scrolling unit </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span> <span style="color: #010001;">yChar</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// vertical scrolling unit </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span> <span style="color: #010001;">xUpper</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// average width of uppercase letters </span></span>

<span style="font-size: 12pt; color: green; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span> <span style="color: #010001;">xPos</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// current horizontal scrolling position </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span> <span style="color: #010001;">yPos</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// current vertical scrolling position </span></span>

<span style="font-size: 12pt; color: green; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span> <span style="color: #010001;">i</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// loop counter </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span> <span style="color: #010001;">x</span>, <span style="color: #010001;">y</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// horizontal and vertical coordinates</span></span>

<span style="font-size: 12pt; color: green; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span> <span style="color: #010001;">FirstLine</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// first line in the invalidated area </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span> <span style="color: #010001;">LastLine</span>;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// last line in the invalidated area </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">HRESULT</span> <span style="color: #010001;">hr</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">size_t</span><span style="mso-spacerun: yes;">&nbsp; </span><span style="color: #010001;">abcLength</span>=0;<span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// length of an abc[] item</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Create an array of lines to display. </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">#define</span> <span style="color: #010001;">LINES</span> 28 </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: #010001;">TCHAR</span> *<span style="color: #010001;">abc</span>[] = { </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"anteater"</span>),<span style="mso-spacerun: yes;">&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"bear"</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"cougar"</span>), </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"dingo"</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"elephant"</span>),<span style="mso-spacerun: yes;">&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"falcon"</span>), </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"gazelle"</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"hyena"</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"iguana"</span>), </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"jackal"</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"kangaroo"</span>),<span style="mso-spacerun: yes;">&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"llama"</span>), </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"moose"</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"newt"</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"octopus"</span>), </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"penguin"</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"quail"</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"rat"</span>), </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"squid"</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"tortoise"</span>),<span style="mso-spacerun: yes;">&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"urus"</span>), </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"vole"</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"walrus"</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"xylophone"</span>), </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"yak"</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"zebra"</span>),</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">"This line contains words, but no character. Go figure."</span>),</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span>(<span style="color: #a31515;">""</span>)</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">//////////////////////////////////////////////////////////////////////////</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">switch</span> (<span style="color: #010001;">message</span>)</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_CREATE</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">CreateWindowEx</span>( </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0L,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// no extended styles </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">_T</span>(<span style="color: #a31515;">"SCROLLBAR"</span>),<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// scroll bar control class </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(<span style="color: #010001;">LPCWSTR</span>) <span style="color: #010001;">NULL</span>,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// text for window title bar </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">WS_CHILD</span> | <span style="color: #010001;">SBS_HORZ</span>,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// scroll bar styles </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// horizontal position </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// vertical position </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>200,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// width of the scroll bar </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>50,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// default height </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hWnd</span>,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// handle to main window </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(<span style="color: #010001;">HMENU</span>) <span style="color: #010001;">NULL</span>,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// no menu for a scroll bar </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hInst</span>,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// instance owning this window </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(<span style="color: #010001;">LPVOID</span>) <span style="color: #010001;">NULL</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// pointer not needed </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>); </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">//////////////////////////////////////////////////////////////////////////</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Get the handle to the client area's device context. </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hdc</span> = <span style="color: #010001;">GetDC</span> (<span style="color: #010001;">hWnd</span>); </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Extract font dimensions from the text metrics. </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">GetTextMetrics</span> (<span style="color: #010001;">hdc</span>, &amp;<span style="color: #010001;">tm</span>); </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">xChar</span> = <span style="color: #010001;">tm</span>.<span style="color: #010001;">tmAveCharWidth</span>; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">xUpper</span> = (<span style="color: #010001;">tm</span>.<span style="color: #010001;">tmPitchAndFamily</span> &amp; 1 ? 3 : 2) * <span style="color: #010001;">xChar</span>/2; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">yChar</span> = <span style="color: #010001;">tm</span>.<span style="color: #010001;">tmHeight</span> + <span style="color: #010001;">tm</span>.<span style="color: #010001;">tmExternalLeading</span>; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Free the device context. </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ReleaseDC</span> (<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">hdc</span>); </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Set an arbitrary maximum width for client area. </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// (xClientMax is the sum of the widths of 48 average </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// lowercase letters and 12 uppercase letters.) </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">xClientMax</span> = 48 * <span style="color: #010001;">xChar</span> + 12 * <span style="color: #010001;">xUpper</span>; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">//////////////////////////////////////////////////////////////////////////</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_COMMAND</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wmId</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">LOWORD</span>(<span style="color: #010001;">wParam</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wmEvent</span> = <span style="color: #010001;">HIWORD</span>(<span style="color: #010001;">wParam</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// </span></span><span style="font-size: 12pt; color: green; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;">分析菜单选择<span lang="EN-US">:</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">switch</span> (<span style="color: #010001;">wmId</span>)</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">IDM_ABOUT</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DialogBox</span>(<span style="color: #010001;">hInst</span>, <span style="color: #010001;">MAKEINTRESOURCE</span>(<span style="color: #010001;">IDD_ABOUTBOX</span>), <span style="color: #010001;">hWnd</span>, <span style="color: #010001;">About</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">IDM_EXIT</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DestroyWindow</span>(<span style="color: #010001;">hWnd</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">default</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> <span style="color: #010001;">DefWindowProc</span>(<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">message</span>, <span style="color: #010001;">wParam</span>, <span style="color: #010001;">lParam</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_SIZE</span>: </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Retrieve the dimensions of the client area. </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">yClient</span> = <span style="color: #010001;">HIWORD</span> (<span style="color: #010001;">lParam</span>); </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">xClient</span> = <span style="color: #010001;">LOWORD</span> (<span style="color: #010001;">lParam</span>); </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Set the vertical scrolling range and page size</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">cbSize</span> = <span style="color: blue;">sizeof</span>(<span style="color: #010001;">si</span>); </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">fMask</span><span style="mso-spacerun: yes;">&nbsp; </span>= <span style="color: #010001;">SIF_RANGE</span> | <span style="color: #010001;">SIF_PAGE</span>; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nMin</span><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>= 0; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nMax</span><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>= <span style="color: #010001;">LINES</span> - 1; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPage</span><span style="mso-spacerun: yes;">&nbsp; </span>= <span style="color: #010001;">yClient</span> / <span style="color: #010001;">yChar</span>; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetScrollInfo</span>(<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_VERT</span>, &amp;<span style="color: #010001;">si</span>, <span style="color: #010001;">TRUE</span>); </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Set the horizontal scrolling range and page size. </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">cbSize</span> = <span style="color: blue;">sizeof</span>(<span style="color: #010001;">si</span>); </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">fMask</span><span style="mso-spacerun: yes;">&nbsp; </span>= <span style="color: #010001;">SIF_RANGE</span> | <span style="color: #010001;">SIF_PAGE</span>; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nMin</span><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>= 0; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nMax</span><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>= 2 + <span style="color: #010001;">xClientMax</span> / <span style="color: #010001;">xChar</span>; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPage</span><span style="mso-spacerun: yes;">&nbsp; </span>= <span style="color: #010001;">xClient</span> / <span style="color: #010001;">xChar</span>; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetScrollInfo</span>(<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_HORZ</span>, &amp;<span style="color: #010001;">si</span>, <span style="color: #010001;">TRUE</span>); </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_HSCROLL</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Get all the vertial scroll bar information</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">cbSize</span> = <span style="color: blue;">sizeof</span> (<span style="color: #010001;">si</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">fMask</span><span style="mso-spacerun: yes;">&nbsp; </span>= <span style="color: #010001;">SIF_ALL</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Save the position for comparison later on</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">GetScrollInfo</span> (<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_HORZ</span>, &amp;<span style="color: #010001;">si</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">xPos</span> = <span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">switch</span> (<span style="color: #010001;">LOWORD</span> (<span style="color: #010001;">wParam</span>))</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked left arrow</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_LINELEFT</span>: </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> -= 1;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked right arrow</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_LINERIGHT</span>: </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> += 1;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked the scroll bar shaft left of the scroll box</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_PAGELEFT</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> -= <span style="color: #010001;">si</span>.<span style="color: #010001;">nPage</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked the scroll bar shaft right of the scroll box</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_PAGERIGHT</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> += <span style="color: #010001;">si</span>.<span style="color: #010001;">nPage</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user dragged the scroll box</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_THUMBTRACK</span>: </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> = <span style="color: #010001;">si</span>.<span style="color: #010001;">nTrackPos</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">default</span> :</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Set the position and then retrieve it.<span style="mso-spacerun: yes;">&nbsp; </span>Due to adjustments</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">//<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>by Windows it may not be the same as the value set.</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">fMask</span> = <span style="color: #010001;">SIF_POS</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetScrollInfo</span> (<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_HORZ</span>, &amp;<span style="color: #010001;">si</span>, <span style="color: #010001;">TRUE</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">GetScrollInfo</span> (<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_HORZ</span>, &amp;<span style="color: #010001;">si</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// If the position has changed, scroll the window </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (<span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> != <span style="color: #010001;">xPos</span>)</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ScrollWindowEx</span>(<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">xChar</span> * (<span style="color: #010001;">xPos</span> - <span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span>), 0, <span style="color: #010001;">NULL</span>, <span style="color: #010001;">NULL</span>,</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;</span><span style="color: #010001;">NULL</span>, <span style="color: #010001;">NULL</span>,<span style="color: #010001;">SW_INVALIDATE</span>|<span style="color: #010001;">SW_ERASE</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">//ScrollWindow(hWnd, xChar * (xPos - si.nPos), 0, NULL, NULL);</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_VSCROLL</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Get all the vertial scroll bar information</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">cbSize</span> = <span style="color: blue;">sizeof</span> (<span style="color: #010001;">si</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">fMask</span><span style="mso-spacerun: yes;">&nbsp; </span>= <span style="color: #010001;">SIF_ALL</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">GetScrollInfo</span> (<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_VERT</span>, &amp;<span style="color: #010001;">si</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Save the position for comparison later on</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">yPos</span> = <span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">switch</span> (<span style="color: #010001;">LOWORD</span> (<span style="color: #010001;">wParam</span>))</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked the HOME keyboard key</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_TOP</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> = <span style="color: #010001;">si</span>.<span style="color: #010001;">nMin</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked the END keyboard key</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_BOTTOM</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> = <span style="color: #010001;">si</span>.<span style="color: #010001;">nMax</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked the top arrow</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_LINEUP</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> -= 1;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked the bottom arrow</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_LINEDOWN</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> += 1;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked the scroll bar shaft above the scroll box</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_PAGEUP</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> -= <span style="color: #010001;">si</span>.<span style="color: #010001;">nPage</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user clicked the scroll bar shaft below the scroll box</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_PAGEDOWN</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> += <span style="color: #010001;">si</span>.<span style="color: #010001;">nPage</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// user dragged the scroll box</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">SB_THUMBTRACK</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> = <span style="color: #010001;">si</span>.<span style="color: #010001;">nTrackPos</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">&nbsp;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">default</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>; </span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Set the position and then retrieve it.<span style="mso-spacerun: yes;">&nbsp; </span>Due to adjustments</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">//<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>by Windows it may not be the same as the value set.</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">fMask</span> = <span style="color: #010001;">SIF_POS</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetScrollInfo</span> (<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_VERT</span>, &amp;<span style="color: #010001;">si</span>, <span style="color: #010001;">TRUE</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">GetScrollInfo</span> (<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_VERT</span>, &amp;<span style="color: #010001;">si</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// If the position has changed, scroll window and update it</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (<span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span> != <span style="color: #010001;">yPos</span>)</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ScrollWindow</span>(<span style="color: #010001;">hWnd</span>, 0, <span style="color: #010001;">yChar</span> * (<span style="color: #010001;">yPos</span> - <span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span>), <span style="color: #010001;">NULL</span>, <span style="color: #010001;">NULL</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">UpdateWindow</span> (<span style="color: #010001;">hWnd</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_PAINT</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Prepare the window for painting</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hdc</span> = <span style="color: #010001;">BeginPaint</span> (<span style="color: #010001;">hWnd</span>, &amp;<span style="color: #010001;">ps</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Get vertical scroll bar position</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">cbSize</span> = <span style="color: blue;">sizeof</span> (<span style="color: #010001;">si</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">si</span>.<span style="color: #010001;">fMask</span><span style="mso-spacerun: yes;">&nbsp; </span>= <span style="color: #010001;">SIF_POS</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">GetScrollInfo</span> (<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_VERT</span>, &amp;<span style="color: #010001;">si</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">yPos</span> = <span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Get horizontal scroll bar position</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">GetScrollInfo</span> (<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">SB_HORZ</span>, &amp;<span style="color: #010001;">si</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">xPos</span> = <span style="color: #010001;">si</span>.<span style="color: #010001;">nPos</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Find painting limits</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">FirstLine</span> = <span style="color: #010001;">max</span> (0, <span style="color: #010001;">yPos</span> + <span style="color: #010001;">ps</span>.<span style="color: #010001;">rcPaint</span>.<span style="color: #010001;">top</span> / <span style="color: #010001;">yChar</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">LastLine</span> = <span style="color: #010001;">min</span> (<span style="color: #010001;">LINES</span> - 1, <span style="color: #010001;">yPos</span> + <span style="color: #010001;">ps</span>.<span style="color: #010001;">rcPaint</span>.<span style="color: #010001;">bottom</span> / <span style="color: #010001;">yChar</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">sprintf</span>(<span style="color: #010001;">szDebug</span>,(<span style="color: #a31515;">"%d,%d,%d,%d/r/n"</span>),<span style="color: #010001;">ps</span>.<span style="color: #010001;">rcPaint</span>.<span style="color: #010001;">left</span>,<span style="color: #010001;">ps</span>.<span style="color: #010001;">rcPaint</span>.<span style="color: #010001;">top</span>,<span style="color: #010001;">ps</span>.<span style="color: #010001;">rcPaint</span>.<span style="color: #010001;">right</span>,<span style="color: #010001;">ps</span>.<span style="color: #010001;">rcPaint</span>.<span style="color: #010001;">bottom</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">OutputDebugStringA</span>(<span style="color: #010001;">szDebug</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ZeroMemory</span>(<span style="color: #010001;">szDebug</span>,0);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">sprintf</span>(<span style="color: #010001;">szDebug</span>,<span style="color: #a31515;">"FirstLine=%d,LastLine=%d/r/n"</span>,<span style="color: #010001;">FirstLine</span>,<span style="color: #010001;">LastLine</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">OutputDebugStringA</span>(<span style="color: #010001;">szDebug</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">for</span> (<span style="color: #010001;">i</span> = <span style="color: #010001;">FirstLine</span>; <span style="color: #010001;">i</span> &lt;= <span style="color: #010001;">LastLine</span>; <span style="color: #010001;">i</span>++)</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">x</span> = <span style="color: #010001;">xChar</span> * (1 - <span style="color: #010001;">xPos</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">y</span> = <span style="color: #010001;">yChar</span> * (<span style="color: #010001;">i</span> - <span style="color: #010001;">yPos</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Note that "55" in the following depends on the </span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// maximum size of an abc[] item.</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">//</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hr</span> = <span style="color: #010001;">StringCchLength</span>(<span style="color: #010001;">abc</span>[<span style="color: #010001;">i</span>], 100, &amp;<span style="color: #010001;">abcLength</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> ((<span style="color: #010001;">FAILED</span>(<span style="color: #010001;">hr</span>)) | (&amp;<span style="color: #010001;">abcLength</span> == <span style="color: #010001;">NULL</span>))</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">/*MessageBox(hWnd,_T("</span></span><span style="font-size: 12pt; color: green; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;">字符串长度为<span lang="EN-US">!"),_T("</span>错误<span lang="EN-US">"),MB_ICONERROR);*/</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">else</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TextOut</span>(<span style="color: #010001;">hdc</span>,<span style="color: #010001;">x</span>,<span style="color: #010001;">y</span>,<span style="color: #010001;">abc</span>[<span style="color: #010001;">i</span>],<span style="color: #010001;">abcLength</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Indicate that painting is finished</span></span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">EndPaint</span> (<span style="color: #010001;">hWnd</span>, &amp;<span style="color: #010001;">ps</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_DESTROY</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PostQuitMessage</span>(0);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">default</span>:</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> <span style="color: #010001;">DefWindowProc</span>(<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">message</span>, <span style="color: #010001;">wParam</span>, <span style="color: #010001;">lParam</span>);</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0;</span>

<span style="font-size: 12pt; font-family: &quot;微软雅黑&quot;,&quot;sans-serif&quot;; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-font-kerning: 0pt; mso-no-proof: yes;" lang="EN-US">}</span>

</div>