---
title: 模板代替虚函数实现多态
id: 197
categories:
  - C++
date: 2008-04-24 13:05:00
tags:
---

    <TABLE style="TABLE-LAYOUT: fixed">
<TBODY>
<TR>
<TD>
<DIV class=cnt id=blog_text>

虚函数和继承的实现：

class File {
&nbsp;&nbsp; public:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; virtual void Open() = 0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; virtual void Save() = 0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; virtual void SaveAS(String&amp;) = 0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; virtual void Close() = 0;
};
class TextFile:public File{
&nbsp;&nbsp; public:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void Open();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void Save();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void SaveAS(String&amp;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void Close();
};
class ImageFile:public File{
&nbsp;&nbsp; public:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void Open();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void Save();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void SaveAS(String&amp;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void Close();
};

// user menu selection to open the file
void menu_open_file(File* f_ptr){
&nbsp;&nbsp; f_ptr-&gt;Open();
&nbsp;&nbsp; ....
&nbsp;&nbsp; ...
}
By using the above code, you would have the following:
File *file_ptr = new TextFile();
menu_open_file(file_ptr);//open the text file
.
.
file_ptr = new ImageFile();
menu_open_file(file_ptr);//open the image file

模板的实现：

class TextFile{
public:
&nbsp;&nbsp; void Open();
};

class ImageFile{
public:
void Open();
};

//user menu selection to open the file

template&lt;typename T&gt; void menu_open_file(T file){
&nbsp;&nbsp; file.Open();
}
Using the code:
TextFile txt_file;
ImageFile img_file;
menu_open_file(txt_file);&nbsp;&nbsp;&nbsp; //open the text file
menu_open_file(img_file);&nbsp;&nbsp;&nbsp; //open the image file
</DIV></TD></TR></TBODY></TABLE>
</div>