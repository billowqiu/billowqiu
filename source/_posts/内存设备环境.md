---
title: 内存设备环境
id: 185
categories:
  - VC
date: 2008-05-07 16:12:00
tags:
---

    

<SPAN style="FONT-SIZE: 12pt; mso-spacerun: yes"><FONT face=宋体>通过使用一个特别为位图操作的设备环境，可以使得应用程序将输出操作在内存中而不是将其发送到实际的设备中。内存设备环境使得系统将一部分内存当作虚拟设备。它就是一个在内存中的位数组，使得应用程序可以使用它为在一个标准的绘图表面创建位图临时存储颜色数据。由于位图是和设备兼容的，因此内存设备环境在某些时候也就当作兼容设备环境。</FONT> </SPAN><SPAN style="FONT-SIZE: 12pt; mso-spacerun: yes"></SPAN>

<SPAN style="FONT-SIZE: 12pt; mso-spacerun: yes"><FONT face=宋体>内存设备环境作为一个特殊的环境存储位图图像。应用程序可以调用</FONT> </SPAN><SPAN>[<FONT color=#0000ff><SPAN style="FONT-WEIGHT: bold; FONT-SIZE: 12pt; TEXT-DECORATION: underline; mso-spacerun: yes">CreateCompatibleDC</SPAN><U> </U></FONT>](ms-help://MS.MSDNQTR.v80.chs/MS.MSDN.v80/MS.WIN32COM.v10.en/gdi/devcons_499f.htm)</SPAN><SPAN style="FONT-SIZE: 12pt; mso-spacerun: yes"><FONT face=宋体>创建一个内存设备环境。</FONT> </SPAN>

<SPAN style="FONT-SIZE: 12pt; mso-spacerun: yes"><FONT face=宋体>内存设备环境中初始的位图只是一个简单的占位符。它的尺寸为1*1像素。在应用程序进行绘制之前，必须通过调用</FONT> </SPAN><SPAN>[<FONT color=#0000ff><SPAN style="FONT-WEIGHT: bold; FONT-SIZE: 12pt; TEXT-DECORATION: underline; mso-spacerun: yes">SelectObject</SPAN><U> </U></FONT>](ms-help://MS.MSDNQTR.v80.chs/MS.MSDN.v80/MS.WIN32COM.v10.en/gdi/devcons_9v3o.htm)</SPAN><SPAN style="FONT-SIZE: 12pt; mso-spacerun: yes"><FONT face=宋体>选择一个恰当宽度和高度的位图到该内存环境中。要创建一个恰当尺寸的位图，可以使用</FONT> </SPAN><SPAN>[<FONT color=#0000ff><SPAN style="FONT-WEIGHT: bold; FONT-SIZE: 12pt; TEXT-DECORATION: underline; mso-spacerun: yes">CreateBitmap</SPAN><U> </U></FONT>](ms-help://MS.MSDNQTR.v80.chs/MS.MSDN.v80/MS.WIN32COM.v10.en/gdi/bitmaps_3ak0.htm)</SPAN><SPAN style="FONT-SIZE: 12pt; mso-spacerun: yes">, </SPAN><SPAN>[<FONT color=#0000ff><SPAN style="FONT-WEIGHT: bold; FONT-SIZE: 12pt; TEXT-DECORATION: underline; mso-spacerun: yes">CreateBitmapIndirect</SPAN><U> </U></FONT>](ms-help://MS.MSDNQTR.v80.chs/MS.MSDN.v80/MS.WIN32COM.v10.en/gdi/bitmaps_6r04.htm)</SPAN><SPAN style="FONT-SIZE: 12pt; mso-spacerun: yes">, or </SPAN><SPAN>[<FONT color=#0000ff><SPAN style="FONT-WEIGHT: bold; FONT-SIZE: 12pt; TEXT-DECORATION: underline; mso-spacerun: yes">CreateCompatibleBitmap</SPAN><U> </U></FONT>](ms-help://MS.MSDNQTR.v80.chs/MS.MSDN.v80/MS.WIN32COM.v10.en/gdi/bitmaps_1cxc.htm)</SPAN><SPAN style="FONT-SIZE: 12pt; mso-spacerun: yes"><FONT face=宋体>三个函数。当位图被选进内存设备环境后，系统用一个足够大的数组取代单位数组来存储指定的矩形像素的颜色信息。</FONT> </SPAN><SPAN style="FONT-SIZE: 12pt; mso-spacerun: yes"></SPAN>

<SPAN style="FONT-SIZE: 12pt; mso-spacerun: yes"><FONT face=宋体>当应用程序传递一个由</FONT> </SPAN><SPAN style="FONT-WEIGHT: bold; FONT-SIZE: 12pt; mso-spacerun: yes">CreateCompatibleDC</SPAN> <SPAN style="FONT-SIZE: 12pt; mso-spacerun: yes"><FONT face=宋体>返回的句柄到绘制函数时，被要求的输出并不会在设备的绘制表面显示。相反，系统会存储线段，曲线，文字或者区域的颜色信息到位数组中。应用程序可以复制存储在内存中的图像到绘制表面通过调用</FONT> </SPAN><SPAN>[<FONT color=#0000ff><SPAN style="FONT-WEIGHT: bold; FONT-SIZE: 12pt; TEXT-DECORATION: underline; mso-spacerun: yes">BitBlt</SPAN><U> </U></FONT>](ms-help://MS.MSDNQTR.v80.chs/MS.MSDN.v80/MS.WIN32COM.v10.en/gdi/bitmaps_0fzo.htm)</SPAN><SPAN style="FONT-SIZE: 12pt; mso-spacerun: yes"><FONT face=宋体>函数，并将内存设备环境作为源设备环境，窗口或者屏幕设备环境作为目标设备环境。</FONT> </SPAN>

</div>